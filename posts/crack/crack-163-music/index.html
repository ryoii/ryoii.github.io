<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title class=pjax-title>网易云接口逆向 - Ryoii Blog</title><meta name=Description content="Ryoii Blog Site"><meta property="og:title" content="网易云接口逆向"><meta property="og:description" content="网页抓包 通过网页 F12 抓包可以发现，几乎所有的网易云接口都发向同一个接口 [POST] https://music.163.com/weapi/cloudsearch/get/web?csrf_token= 其中携带了两个请求参数 params 和 encSecKey。通过请求回放可以成功返"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.ryoii.cn/posts/crack/crack-163-music/"><meta property="og:image" content="https://blog.ryoii.cn/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-03T15:47:11+08:00"><meta property="article:modified_time" content="2022-08-03T15:47:11+08:00"><meta property="og:site_name" content="Ryoii Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.ryoii.cn/logo.png"><meta name=twitter:title content="网易云接口逆向"><meta name=twitter:description content="网页抓包 通过网页 F12 抓包可以发现，几乎所有的网易云接口都发向同一个接口 [POST] https://music.163.com/weapi/cloudsearch/get/web?csrf_token= 其中携带了两个请求参数 params 和 encSecKey。通过请求回放可以成功返"><meta name=application-name content="Ryoii Blog"><meta name=apple-mobile-web-app-title content="Ryoii Blog"><meta name=theme-color content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://blog.ryoii.cn/posts/crack/crack-163-music/><link rel=prev href=https://blog.ryoii.cn/posts/test/cors-test/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/fontawesome-free/all.min.css><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/animate/animate.min.css><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"网易云接口逆向","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.ryoii.cn\/posts\/crack\/crack-163-music\/"},"genre":"posts","keywords":"逆向","wordcount":11508,"url":"https:\/\/blog.ryoii.cn\/posts\/crack\/crack-163-music\/","datePublished":"2022-08-03T15:47:11+08:00","dateModified":"2022-08-03T15:47:11+08:00","publisher":{"@type":"Organization","name":"作者"},"authors":[{"@type":"Person","name":"ryoii"}],"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e)}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(e){const t=document.getElementsByTagName("meta");for(let n=0;n<t.length;n++)if(t[n].getAttribute("name")===e)return t[n];return""}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"||e==="black"?setTheme(e):setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}else"dark"==="light"||"dark"==="dark"||"dark"==="black"?(setTheme("dark"),saveTheme("dark")):(saveTheme("auto"),setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"));let metaColors={light:"#f8f8f8",dark:"#252627",black:"#000000"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")]</script><div id=back-to-top></div><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Ryoii Blog"><span id=desktop-header-typeit class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>所有文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/series/>系列 </a><a class=menu-item href=/about>关于 </a><a class=menu-item href=https://github.com/ryoii title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=# onclick=return!1 class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=# onclick=return!1 class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=# onclick=return!1 class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Ryoii Blog"><span id=mobile-header-typeit class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=# onclick=return!1 class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=# onclick=return!1 class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=# onclick=return!1 class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>所有文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a class=menu-item href=/series/ title>系列</a><a class=menu-item href=/about title>关于</a><a class=menu-item href=https://github.com/ryoii title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i></a><a href=# onclick=return!1 class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><script>document.getElementsByTagName("main")[0].setAttribute("pageStyle","normal")</script><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">网易云接口逆向</h1><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="author fas fa-user-circle fa-fw"></i><span class=screen-reader-text> </span><a href=https://blog.ryoii.cn/authors/ryoii>ryoii</a></span></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-08-03>2022-08-03</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime=2022-08-03>2022-08-03</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 11508 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 23 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#网页抓包>网页抓包</a></li><li><a href=#js-检索>js 检索</a><ul><li><ul><li><a href=#i4m>i4m</a></li><li><a href=#buv4z>buV4z</a></li><li><a href=#windowasrsea>window.asrsea</a></li></ul></li></ul></li><li><a href=#寻找一组可用参数>寻找一组可用参数</a></li><li><a href=#实际调试>实际调试</a><ul><li><ul><li><a href=#调试>调试</a></li></ul></li></ul></li><li><a href=#分析-aes-加密>分析 AES 加密</a></li><li><a href=#奇怪的-rsa-算法>奇怪的 RSA 算法</a></li><li><a href=#尾声>尾声</a></li><li><a href=#题外话>题外话</a></li></ul></nav></div></div><div class=content id=content><h2 id=网页抓包>网页抓包</h2><p>通过网页 F12 抓包可以发现，几乎所有的网易云接口都发向同一个接口 <code>[POST] https://music.163.com/weapi/cloudsearch/get/web?csrf_token=</code></p><p>其中携带了两个请求参数 <code>params</code> 和 <code>encSecKey</code>。通过请求回放可以成功返回，说明请求没有一次性过期的参数。将请求参数复制到 API 调试工具也能成功返回，说明不需要特殊请求头。</p><p>因此，开始分析 <code>params</code> 和 <code>encSecKey</code> 的构造。</p><h2 id=js-检索>js 检索</h2><p>在 <code>Chrome</code> 的调试中全局检索(Ctrl + Shift + F) 关键字 <code>encSecKey</code>，可以发现这个变量只在 <code>core_{hash}.js</code> 文件中出现过两次。</p><p>其中一次如下，这里一大段都是请求路径、请求参数匹配，url 替换等逻辑，抛去这些代码后，关键的地方就几行。很明显，这里就是生成两个请求参数的地方了，并把参数放到请求的 <code>data</code> 里。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>bKB6v</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>asrsea</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>i4m</span><span class=p>),</span> <span class=nx>buV4Z</span><span class=p>([</span><span class=s2>&#34;流泪&#34;</span><span class=p>,</span> <span class=s2>&#34;强&#34;</span><span class=p>]),</span> <span class=nx>buV4Z</span><span class=p>(</span><span class=nx>Rg0x</span><span class=p>.</span><span class=nx>md</span><span class=p>),</span> <span class=nx>buV4Z</span><span class=p>([</span><span class=s2>&#34;爱心&#34;</span><span class=p>,</span> <span class=s2>&#34;女孩&#34;</span><span class=p>,</span> <span class=s2>&#34;惊恐&#34;</span><span class=p>,</span> <span class=s2>&#34;大笑&#34;</span><span class=p>]));</span>
</span></span><span class=line><span class=cl><span class=nx>e4i</span><span class=p>.</span><span class=nx>data</span> <span class=o>=</span> <span class=nx>j4n</span><span class=p>.</span><span class=nx>cr5w</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>params</span><span class=o>:</span> <span class=nx>bKB6v</span><span class=p>.</span><span class=nx>encText</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>encSecKey</span><span class=o>:</span> <span class=nx>bKB6v</span><span class=p>.</span><span class=nx>encSecKey</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=c1>// ...
</span></span></span></code></pre></td></tr></table></div></div><p>这里出现了 <code>encSecKey</code>，是 <code>bkB6v</code> 变量的一个属性。那可以推断，另一次出现 <code>encSecKey</code> 应该就是构造 <code>bkB6v</code> 对象的方法了（后续分析结果也确实如此）。</p><p>这里由 3 个地方值得注意。<code>i4m</code>, <code>buV4z</code>, <code>window.asrsea</code>。我们依次分析。</p><blockquote><p>不同版本的 <code>core.js</code> 可能混淆出来的变量名并不相同</p></blockquote><h4 id=i4m>i4m</h4><p>通过上下文可以发现 <code>i4m</code> 通过 url 的 <code>path</code>, <code>query</code>, <code>body</code> 等地方进行判断生成的，很可能就是实际的请求参数。我们打下断点，最终得到了 <code>i4m</code> 变量的值。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;hlpretag&#34;</span><span class=p>:</span><span class=s2>&#34;&lt;span class=\&#34;s-fc7\&#34;&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;hlposttag&#34;</span><span class=p>:</span><span class=s2>&#34;&lt;/span&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span><span class=s2>&#34;19723756&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;s&#34;</span><span class=p>:</span><span class=s2>&#34;daddydaddydo&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;offset&#34;</span><span class=p>:</span><span class=s2>&#34;0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;total&#34;</span><span class=p>:</span><span class=s2>&#34;true&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;limit&#34;</span><span class=p>:</span><span class=s2>&#34;30&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;csrf_token&#34;</span><span class=p>:</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>完美。这里就是歌曲搜索接口可能的参数，包括关键字、分页。可以推断，后续通过 <code>JSON.stringify(i4m)</code> 序列化成字符串后进行了加密。</p><h4 id=buv4z>buV4z</h4><p><code>core.js</code> 中搜索这个变量可以找到这是一个 <code>function</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>buV4Z</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>chL0x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>m4q</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>        <span class=nx>j4n</span><span class=p>.</span><span class=nx>bg4k</span><span class=p>(</span><span class=nx>chL0x</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>chE0x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>m4q</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>Rg0x</span><span class=p>.</span><span class=nx>emj</span><span class=p>[</span><span class=nx>chE0x</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>m4q</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><p>可以猜测，这里表示 <code>foreach</code>, 遍历 <code>chL0x</code> 并通过 <code>Rg0x.emj</code> 映射后拼接成字符串。找到 <code>Rg0x.emj</code> 确实是一个 <code>map</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>Rg0x</span><span class=p>.</span><span class=nx>emj</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;色&#34;</span><span class=o>:</span> <span class=s2>&#34;00e0b&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;流感&#34;</span><span class=o>:</span> <span class=s2>&#34;509f6&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;这边&#34;</span><span class=o>:</span> <span class=s2>&#34;259df&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;弱&#34;</span><span class=o>:</span> <span class=s2>&#34;8642d&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;嘴唇&#34;</span><span class=o>:</span> <span class=s2>&#34;bc356&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;亲&#34;</span><span class=o>:</span> <span class=s2>&#34;62901&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>     <span class=s2>&#34;开心&#34;</span><span class=o>:</span> <span class=s2>&#34;477df&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;呲牙&#34;</span><span class=o>:</span> <span class=s2>&#34;22677&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;憨笑&#34;</span><span class=o>:</span> <span class=s2>&#34;ec152&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ......
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>通过在 <code>console</code> 或者 <code>nodejs</code> 等环境执行下这个代码，可以得到 <code>window.asrsea</code> 的几个实际参数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 010001
</span></span></span><span class=line><span class=cl><span class=c1>// 00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 0CoJUm6Qyw8W8jud
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>asrsea</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>i4m</span><span class=p>),</span> <span class=nx>buV4Z</span><span class=p>([</span><span class=s2>&#34;流泪&#34;</span><span class=p>,</span> <span class=s2>&#34;强&#34;</span><span class=p>]),</span> <span class=nx>buV4Z</span><span class=p>(</span><span class=nx>Rg0x</span><span class=p>.</span><span class=nx>md</span><span class=p>),</span> <span class=nx>buV4Z</span><span class=p>([</span><span class=s2>&#34;爱心&#34;</span><span class=p>,</span> <span class=s2>&#34;女孩&#34;</span><span class=p>,</span> <span class=s2>&#34;惊恐&#34;</span><span class=p>,</span> <span class=s2>&#34;大笑&#34;</span><span class=p>]));</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=windowasrsea>window.asrsea</h4><p>全局搜索 <code>window.asrsea</code> 发现只有一个地方有定义</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>a</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>b</span> <span class=o>=</span> <span class=s2>&#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#34;</span><span class=p>,</span> <span class=nx>c</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=nx>d</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>a</span> <span class=o>&gt;</span> <span class=nx>d</span><span class=p>;</span> <span class=nx>d</span> <span class=o>+=</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>e</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span> <span class=o>*</span> <span class=nx>b</span><span class=p>.</span><span class=nx>length</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>e</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nx>e</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>c</span> <span class=o>+=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>charAt</span><span class=p>(</span><span class=nx>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>c</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>b</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>enc</span><span class=p>.</span><span class=nx>Utf8</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>,</span> <span class=nx>d</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>enc</span><span class=p>.</span><span class=nx>Utf8</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=s2>&#34;0102030405060708&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>,</span> <span class=nx>e</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>enc</span><span class=p>.</span><span class=nx>Utf8</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>,</span> <span class=nx>f</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>AES</span><span class=p>.</span><span class=nx>encrypt</span><span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>iv</span><span class=o>:</span> <span class=nx>d</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>mode</span><span class=o>:</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>mode</span><span class=p>.</span><span class=nx>CBC</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>f</span><span class=p>.</span><span class=nx>toString</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>c</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>setMaxDigits</span><span class=p>(</span><span class=mi>131</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>RSAKeyPair</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span><span class=s2>&#34;&#34;</span><span class=p>,</span><span class=nx>c</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>e</span> <span class=o>=</span> <span class=nx>encryptedString</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>d</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>g</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>h</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>          <span class=p>,</span> <span class=nx>i</span> <span class=o>=</span> <span class=nx>a</span><span class=p>(</span><span class=mi>16</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>h</span><span class=p>.</span><span class=nx>encText</span> <span class=o>=</span> <span class=nx>b</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>g</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>h</span><span class=p>.</span><span class=nx>encText</span> <span class=o>=</span> <span class=nx>b</span><span class=p>(</span><span class=nx>h</span><span class=p>.</span><span class=nx>encText</span><span class=p>,</span> <span class=nx>i</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>h</span><span class=p>.</span><span class=nx>encSecKey</span> <span class=o>=</span> <span class=nx>c</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>f</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>h</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>e</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>f</span> <span class=o>=</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>f</span><span class=p>.</span><span class=nx>encText</span> <span class=o>=</span> <span class=nx>c</span><span class=p>(</span><span class=nx>a</span> <span class=o>+</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>d</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>f</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nb>window</span><span class=p>.</span><span class=nx>asrsea</span> <span class=o>=</span> <span class=nx>d</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nb>window</span><span class=p>.</span><span class=nx>ecnonasr</span> <span class=o>=</span> <span class=nx>e</span>
</span></span></code></pre></td></tr></table></div></div><p><code>window.asrsea</code> 也就是 <code>d</code> 方法。这里的核心也是 <code>d</code> 方法，在 <code>d</code> 方法中生成了 <code>encText</code> 即 <code>params</code> 和 <code>encSecKey</code>。</p><p><code>a, b, c</code> 方法都是被 <code>d</code> 方法调用的。</p><p>可以简易分析下，<code>a</code> 方法是一个随机数生成方法，<code>b</code> 方法是 <code>AES</code> 加密方法, <code>c</code> 方法是 <code>RSA</code> 加密方法。<code>d</code> 方法生成一个随机数，并通过 3 此加密分别生成 <code>encText</code> 和 <code>encSecKey</code>。</p><p>结合前文提到的 <code>window.asrsea</code> 的参数，可以得到</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>d</span><span class=p>(</span><span class=nx>json</span><span class=p>,</span> <span class=nx>k1</span><span class=p>,</span> <span class=nx>k2</span><span class=p>,</span> <span class=nx>k3</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>r</span> <span class=o>=</span> <span class=nx>random</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>encText</span> <span class=o>=</span> <span class=nx>AES</span><span class=p>(</span><span class=nx>AES</span><span class=p>(</span><span class=nx>json</span><span class=p>,</span> <span class=nx>k3</span><span class=p>),</span> <span class=nx>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>encSecKey</span> <span class=o>=</span> <span class=nx>RSA</span><span class=p>(</span><span class=nx>r</span><span class=p>,</span> <span class=nx>k1</span><span class=p>,</span> <span class=nx>k2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>至此，请求参数的生成逻辑已经很明确了。但是，我们还需要找到加密的逻辑。虽然 <code>AES</code> 和 <code>RSA</code> 都是常用的加密算法，但是也有参数需要配置，而加密方法可可能会自行实现。</p><h2 id=寻找一组可用参数>寻找一组可用参数</h2><p>我们需要找到一组可以供我们后续测试加密代码的参数，通过 <code>console</code> 的 debug 功能找到以下参数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>json</span> <span class=o>=</span> <span class=s2>&#34;{\&#34;hlpretag\&#34;:\&#34;&lt;span class=\\\&#34;s-fc7\\\&#34;&gt;\&#34;,\&#34;hlposttag\&#34;:\&#34;&lt;/span&gt;\&#34;,\&#34;id\&#34;:\&#34;19723756\&#34;,\&#34;s\&#34;:\&#34;daddydaddydo\&#34;,\&#34;type\&#34;:\&#34;1\&#34;,\&#34;offset\&#34;:\&#34;0\&#34;,\&#34;total\&#34;:\&#34;true\&#34;,\&#34;limit\&#34;:\&#34;30\&#34;,\&#34;csrf_token\&#34;:\&#34;\&#34;}&#34;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>k1</span> <span class=o>=</span> <span class=s2>&#34;010001&#34;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>k2</span> <span class=o>=</span> <span class=s2>&#34;00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7&#34;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>k3</span> <span class=o>=</span> <span class=s2>&#34;0CoJUm6Qyw8W8jud&#34;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>random</span> <span class=o>=</span> <span class=s2>&#34;29MLTcVbKsvktpRV&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 输出结果
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>params</span> <span class=o>=</span> <span class=s2>&#34;fS15fDwPSPzRvd8OYwEnU2P/l/11+QKvMzWEy/EOn2RpIFXFYuDnEJrioOK25vaUCKckA2MPliSOq6gT5DtWQvEYq15QPvzphiPEUrd8Oj+UhTvOAfRE8v8gyrc8Ik5w6RyqosC3SqapEgPTagS0+l6yxhgwz8sWhL9yMn3SpgCJcnQ94YdKbxXVwpwXrO54HLHJSwzhKRECVsPU4rU+dvMbP2Z2x6HHUlOC3WYWdGkaj7h3PYivOKq3/yPgKyp9uExonxdn6aSAR46v5NSRk+6g+fqt9hR/UuKDXtKXVtbBGOFUbb/8Ns+m4Hj7k1Js&#34;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>encSecKey</span> <span class=o>=</span> <span class=s2>&#34;c04eb0eddbafdf8dc6d2b322d4d9c32dc2dbfe8a21711c6196cd4ee134e0ef5ca781a198c7e33970b1e620abb594f03a011e40b2a690c830be4644c0adbb4337cb12d003236f04697eeff1a503e834eeb7ac06ef845786a430d19472a0c88eda5719492b586aba0d59acbee60315f0e91a205cc98eeb58d189d562dd2b74c5a5&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>也就说，我们要找到能正确输出结果的 AES 和 RSA 算法即可</p><h2 id=实际调试>实际调试</h2><p>我们把 core 中的关键代码拷贝出来，并手动调用 <code>d</code> 方法来验证我们的结果。这里需要把生成随机数的方法改成返回我们 debug 获取到的随机数。避免调试 js 的时候每次结果都不一样。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>a</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// var d, e, b = &#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#34;, c = &#34;&#34;;
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// for (d = 0; a &gt; d; d += 1)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>//     e = Math.random() * b.length,
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>//     e = Math.floor(e),
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>//     c += b.charAt(e);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// return c
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=s2>&#34;29MLTcVbKsvktpRV&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>b</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>enc</span><span class=p>.</span><span class=nx>Utf8</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>,</span> <span class=nx>d</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>enc</span><span class=p>.</span><span class=nx>Utf8</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=s2>&#34;0102030405060708&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>,</span> <span class=nx>e</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>enc</span><span class=p>.</span><span class=nx>Utf8</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>,</span> <span class=nx>f</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>AES</span><span class=p>.</span><span class=nx>encrypt</span><span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>iv</span><span class=o>:</span> <span class=nx>d</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>mode</span><span class=o>:</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>mode</span><span class=p>.</span><span class=nx>CBC</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>f</span><span class=p>.</span><span class=nx>toString</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>c</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>setMaxDigits</span><span class=p>(</span><span class=mi>131</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>RSAKeyPair</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span><span class=s2>&#34;&#34;</span><span class=p>,</span><span class=nx>c</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>e</span> <span class=o>=</span> <span class=nx>encryptedString</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>d</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>g</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>h</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>          <span class=p>,</span> <span class=nx>i</span> <span class=o>=</span> <span class=nx>a</span><span class=p>(</span><span class=mi>16</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>h</span><span class=p>.</span><span class=nx>encText</span> <span class=o>=</span> <span class=nx>b</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>g</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>h</span><span class=p>.</span><span class=nx>encText</span> <span class=o>=</span> <span class=nx>b</span><span class=p>(</span><span class=nx>h</span><span class=p>.</span><span class=nx>encText</span><span class=p>,</span> <span class=nx>i</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>h</span><span class=p>.</span><span class=nx>encSecKey</span> <span class=o>=</span> <span class=nx>c</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>f</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>h</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>d</span><span class=p>(</span><span class=nx>json</span><span class=p>,</span> <span class=nx>k1</span><span class=p>,</span> <span class=nx>k2</span><span class=p>,</span> <span class=nx>k3</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>执行后报错是必然了，这么大个 js 文件怎么可以只有这点内容。我们一个个把缺失的函数补上。在补的过程中留意一些共同特征</p><ul><li>CryptoJS 是实现在 core.js 里的加密库，AES, RSA 加密都挂载在这个对象下面</li><li>biXXXXX 方法都是 BigInt 相关的方法，参与大数计算，主要是在 RSA 中使用</li></ul><p>这里提供一份补充完整的代码</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>   1
</span><span class=lnt>   2
</span><span class=lnt>   3
</span><span class=lnt>   4
</span><span class=lnt>   5
</span><span class=lnt>   6
</span><span class=lnt>   7
</span><span class=lnt>   8
</span><span class=lnt>   9
</span><span class=lnt>  10
</span><span class=lnt>  11
</span><span class=lnt>  12
</span><span class=lnt>  13
</span><span class=lnt>  14
</span><span class=lnt>  15
</span><span class=lnt>  16
</span><span class=lnt>  17
</span><span class=lnt>  18
</span><span class=lnt>  19
</span><span class=lnt>  20
</span><span class=lnt>  21
</span><span class=lnt>  22
</span><span class=lnt>  23
</span><span class=lnt>  24
</span><span class=lnt>  25
</span><span class=lnt>  26
</span><span class=lnt>  27
</span><span class=lnt>  28
</span><span class=lnt>  29
</span><span class=lnt>  30
</span><span class=lnt>  31
</span><span class=lnt>  32
</span><span class=lnt>  33
</span><span class=lnt>  34
</span><span class=lnt>  35
</span><span class=lnt>  36
</span><span class=lnt>  37
</span><span class=lnt>  38
</span><span class=lnt>  39
</span><span class=lnt>  40
</span><span class=lnt>  41
</span><span class=lnt>  42
</span><span class=lnt>  43
</span><span class=lnt>  44
</span><span class=lnt>  45
</span><span class=lnt>  46
</span><span class=lnt>  47
</span><span class=lnt>  48
</span><span class=lnt>  49
</span><span class=lnt>  50
</span><span class=lnt>  51
</span><span class=lnt>  52
</span><span class=lnt>  53
</span><span class=lnt>  54
</span><span class=lnt>  55
</span><span class=lnt>  56
</span><span class=lnt>  57
</span><span class=lnt>  58
</span><span class=lnt>  59
</span><span class=lnt>  60
</span><span class=lnt>  61
</span><span class=lnt>  62
</span><span class=lnt>  63
</span><span class=lnt>  64
</span><span class=lnt>  65
</span><span class=lnt>  66
</span><span class=lnt>  67
</span><span class=lnt>  68
</span><span class=lnt>  69
</span><span class=lnt>  70
</span><span class=lnt>  71
</span><span class=lnt>  72
</span><span class=lnt>  73
</span><span class=lnt>  74
</span><span class=lnt>  75
</span><span class=lnt>  76
</span><span class=lnt>  77
</span><span class=lnt>  78
</span><span class=lnt>  79
</span><span class=lnt>  80
</span><span class=lnt>  81
</span><span class=lnt>  82
</span><span class=lnt>  83
</span><span class=lnt>  84
</span><span class=lnt>  85
</span><span class=lnt>  86
</span><span class=lnt>  87
</span><span class=lnt>  88
</span><span class=lnt>  89
</span><span class=lnt>  90
</span><span class=lnt>  91
</span><span class=lnt>  92
</span><span class=lnt>  93
</span><span class=lnt>  94
</span><span class=lnt>  95
</span><span class=lnt>  96
</span><span class=lnt>  97
</span><span class=lnt>  98
</span><span class=lnt>  99
</span><span class=lnt> 100
</span><span class=lnt> 101
</span><span class=lnt> 102
</span><span class=lnt> 103
</span><span class=lnt> 104
</span><span class=lnt> 105
</span><span class=lnt> 106
</span><span class=lnt> 107
</span><span class=lnt> 108
</span><span class=lnt> 109
</span><span class=lnt> 110
</span><span class=lnt> 111
</span><span class=lnt> 112
</span><span class=lnt> 113
</span><span class=lnt> 114
</span><span class=lnt> 115
</span><span class=lnt> 116
</span><span class=lnt> 117
</span><span class=lnt> 118
</span><span class=lnt> 119
</span><span class=lnt> 120
</span><span class=lnt> 121
</span><span class=lnt> 122
</span><span class=lnt> 123
</span><span class=lnt> 124
</span><span class=lnt> 125
</span><span class=lnt> 126
</span><span class=lnt> 127
</span><span class=lnt> 128
</span><span class=lnt> 129
</span><span class=lnt> 130
</span><span class=lnt> 131
</span><span class=lnt> 132
</span><span class=lnt> 133
</span><span class=lnt> 134
</span><span class=lnt> 135
</span><span class=lnt> 136
</span><span class=lnt> 137
</span><span class=lnt> 138
</span><span class=lnt> 139
</span><span class=lnt> 140
</span><span class=lnt> 141
</span><span class=lnt> 142
</span><span class=lnt> 143
</span><span class=lnt> 144
</span><span class=lnt> 145
</span><span class=lnt> 146
</span><span class=lnt> 147
</span><span class=lnt> 148
</span><span class=lnt> 149
</span><span class=lnt> 150
</span><span class=lnt> 151
</span><span class=lnt> 152
</span><span class=lnt> 153
</span><span class=lnt> 154
</span><span class=lnt> 155
</span><span class=lnt> 156
</span><span class=lnt> 157
</span><span class=lnt> 158
</span><span class=lnt> 159
</span><span class=lnt> 160
</span><span class=lnt> 161
</span><span class=lnt> 162
</span><span class=lnt> 163
</span><span class=lnt> 164
</span><span class=lnt> 165
</span><span class=lnt> 166
</span><span class=lnt> 167
</span><span class=lnt> 168
</span><span class=lnt> 169
</span><span class=lnt> 170
</span><span class=lnt> 171
</span><span class=lnt> 172
</span><span class=lnt> 173
</span><span class=lnt> 174
</span><span class=lnt> 175
</span><span class=lnt> 176
</span><span class=lnt> 177
</span><span class=lnt> 178
</span><span class=lnt> 179
</span><span class=lnt> 180
</span><span class=lnt> 181
</span><span class=lnt> 182
</span><span class=lnt> 183
</span><span class=lnt> 184
</span><span class=lnt> 185
</span><span class=lnt> 186
</span><span class=lnt> 187
</span><span class=lnt> 188
</span><span class=lnt> 189
</span><span class=lnt> 190
</span><span class=lnt> 191
</span><span class=lnt> 192
</span><span class=lnt> 193
</span><span class=lnt> 194
</span><span class=lnt> 195
</span><span class=lnt> 196
</span><span class=lnt> 197
</span><span class=lnt> 198
</span><span class=lnt> 199
</span><span class=lnt> 200
</span><span class=lnt> 201
</span><span class=lnt> 202
</span><span class=lnt> 203
</span><span class=lnt> 204
</span><span class=lnt> 205
</span><span class=lnt> 206
</span><span class=lnt> 207
</span><span class=lnt> 208
</span><span class=lnt> 209
</span><span class=lnt> 210
</span><span class=lnt> 211
</span><span class=lnt> 212
</span><span class=lnt> 213
</span><span class=lnt> 214
</span><span class=lnt> 215
</span><span class=lnt> 216
</span><span class=lnt> 217
</span><span class=lnt> 218
</span><span class=lnt> 219
</span><span class=lnt> 220
</span><span class=lnt> 221
</span><span class=lnt> 222
</span><span class=lnt> 223
</span><span class=lnt> 224
</span><span class=lnt> 225
</span><span class=lnt> 226
</span><span class=lnt> 227
</span><span class=lnt> 228
</span><span class=lnt> 229
</span><span class=lnt> 230
</span><span class=lnt> 231
</span><span class=lnt> 232
</span><span class=lnt> 233
</span><span class=lnt> 234
</span><span class=lnt> 235
</span><span class=lnt> 236
</span><span class=lnt> 237
</span><span class=lnt> 238
</span><span class=lnt> 239
</span><span class=lnt> 240
</span><span class=lnt> 241
</span><span class=lnt> 242
</span><span class=lnt> 243
</span><span class=lnt> 244
</span><span class=lnt> 245
</span><span class=lnt> 246
</span><span class=lnt> 247
</span><span class=lnt> 248
</span><span class=lnt> 249
</span><span class=lnt> 250
</span><span class=lnt> 251
</span><span class=lnt> 252
</span><span class=lnt> 253
</span><span class=lnt> 254
</span><span class=lnt> 255
</span><span class=lnt> 256
</span><span class=lnt> 257
</span><span class=lnt> 258
</span><span class=lnt> 259
</span><span class=lnt> 260
</span><span class=lnt> 261
</span><span class=lnt> 262
</span><span class=lnt> 263
</span><span class=lnt> 264
</span><span class=lnt> 265
</span><span class=lnt> 266
</span><span class=lnt> 267
</span><span class=lnt> 268
</span><span class=lnt> 269
</span><span class=lnt> 270
</span><span class=lnt> 271
</span><span class=lnt> 272
</span><span class=lnt> 273
</span><span class=lnt> 274
</span><span class=lnt> 275
</span><span class=lnt> 276
</span><span class=lnt> 277
</span><span class=lnt> 278
</span><span class=lnt> 279
</span><span class=lnt> 280
</span><span class=lnt> 281
</span><span class=lnt> 282
</span><span class=lnt> 283
</span><span class=lnt> 284
</span><span class=lnt> 285
</span><span class=lnt> 286
</span><span class=lnt> 287
</span><span class=lnt> 288
</span><span class=lnt> 289
</span><span class=lnt> 290
</span><span class=lnt> 291
</span><span class=lnt> 292
</span><span class=lnt> 293
</span><span class=lnt> 294
</span><span class=lnt> 295
</span><span class=lnt> 296
</span><span class=lnt> 297
</span><span class=lnt> 298
</span><span class=lnt> 299
</span><span class=lnt> 300
</span><span class=lnt> 301
</span><span class=lnt> 302
</span><span class=lnt> 303
</span><span class=lnt> 304
</span><span class=lnt> 305
</span><span class=lnt> 306
</span><span class=lnt> 307
</span><span class=lnt> 308
</span><span class=lnt> 309
</span><span class=lnt> 310
</span><span class=lnt> 311
</span><span class=lnt> 312
</span><span class=lnt> 313
</span><span class=lnt> 314
</span><span class=lnt> 315
</span><span class=lnt> 316
</span><span class=lnt> 317
</span><span class=lnt> 318
</span><span class=lnt> 319
</span><span class=lnt> 320
</span><span class=lnt> 321
</span><span class=lnt> 322
</span><span class=lnt> 323
</span><span class=lnt> 324
</span><span class=lnt> 325
</span><span class=lnt> 326
</span><span class=lnt> 327
</span><span class=lnt> 328
</span><span class=lnt> 329
</span><span class=lnt> 330
</span><span class=lnt> 331
</span><span class=lnt> 332
</span><span class=lnt> 333
</span><span class=lnt> 334
</span><span class=lnt> 335
</span><span class=lnt> 336
</span><span class=lnt> 337
</span><span class=lnt> 338
</span><span class=lnt> 339
</span><span class=lnt> 340
</span><span class=lnt> 341
</span><span class=lnt> 342
</span><span class=lnt> 343
</span><span class=lnt> 344
</span><span class=lnt> 345
</span><span class=lnt> 346
</span><span class=lnt> 347
</span><span class=lnt> 348
</span><span class=lnt> 349
</span><span class=lnt> 350
</span><span class=lnt> 351
</span><span class=lnt> 352
</span><span class=lnt> 353
</span><span class=lnt> 354
</span><span class=lnt> 355
</span><span class=lnt> 356
</span><span class=lnt> 357
</span><span class=lnt> 358
</span><span class=lnt> 359
</span><span class=lnt> 360
</span><span class=lnt> 361
</span><span class=lnt> 362
</span><span class=lnt> 363
</span><span class=lnt> 364
</span><span class=lnt> 365
</span><span class=lnt> 366
</span><span class=lnt> 367
</span><span class=lnt> 368
</span><span class=lnt> 369
</span><span class=lnt> 370
</span><span class=lnt> 371
</span><span class=lnt> 372
</span><span class=lnt> 373
</span><span class=lnt> 374
</span><span class=lnt> 375
</span><span class=lnt> 376
</span><span class=lnt> 377
</span><span class=lnt> 378
</span><span class=lnt> 379
</span><span class=lnt> 380
</span><span class=lnt> 381
</span><span class=lnt> 382
</span><span class=lnt> 383
</span><span class=lnt> 384
</span><span class=lnt> 385
</span><span class=lnt> 386
</span><span class=lnt> 387
</span><span class=lnt> 388
</span><span class=lnt> 389
</span><span class=lnt> 390
</span><span class=lnt> 391
</span><span class=lnt> 392
</span><span class=lnt> 393
</span><span class=lnt> 394
</span><span class=lnt> 395
</span><span class=lnt> 396
</span><span class=lnt> 397
</span><span class=lnt> 398
</span><span class=lnt> 399
</span><span class=lnt> 400
</span><span class=lnt> 401
</span><span class=lnt> 402
</span><span class=lnt> 403
</span><span class=lnt> 404
</span><span class=lnt> 405
</span><span class=lnt> 406
</span><span class=lnt> 407
</span><span class=lnt> 408
</span><span class=lnt> 409
</span><span class=lnt> 410
</span><span class=lnt> 411
</span><span class=lnt> 412
</span><span class=lnt> 413
</span><span class=lnt> 414
</span><span class=lnt> 415
</span><span class=lnt> 416
</span><span class=lnt> 417
</span><span class=lnt> 418
</span><span class=lnt> 419
</span><span class=lnt> 420
</span><span class=lnt> 421
</span><span class=lnt> 422
</span><span class=lnt> 423
</span><span class=lnt> 424
</span><span class=lnt> 425
</span><span class=lnt> 426
</span><span class=lnt> 427
</span><span class=lnt> 428
</span><span class=lnt> 429
</span><span class=lnt> 430
</span><span class=lnt> 431
</span><span class=lnt> 432
</span><span class=lnt> 433
</span><span class=lnt> 434
</span><span class=lnt> 435
</span><span class=lnt> 436
</span><span class=lnt> 437
</span><span class=lnt> 438
</span><span class=lnt> 439
</span><span class=lnt> 440
</span><span class=lnt> 441
</span><span class=lnt> 442
</span><span class=lnt> 443
</span><span class=lnt> 444
</span><span class=lnt> 445
</span><span class=lnt> 446
</span><span class=lnt> 447
</span><span class=lnt> 448
</span><span class=lnt> 449
</span><span class=lnt> 450
</span><span class=lnt> 451
</span><span class=lnt> 452
</span><span class=lnt> 453
</span><span class=lnt> 454
</span><span class=lnt> 455
</span><span class=lnt> 456
</span><span class=lnt> 457
</span><span class=lnt> 458
</span><span class=lnt> 459
</span><span class=lnt> 460
</span><span class=lnt> 461
</span><span class=lnt> 462
</span><span class=lnt> 463
</span><span class=lnt> 464
</span><span class=lnt> 465
</span><span class=lnt> 466
</span><span class=lnt> 467
</span><span class=lnt> 468
</span><span class=lnt> 469
</span><span class=lnt> 470
</span><span class=lnt> 471
</span><span class=lnt> 472
</span><span class=lnt> 473
</span><span class=lnt> 474
</span><span class=lnt> 475
</span><span class=lnt> 476
</span><span class=lnt> 477
</span><span class=lnt> 478
</span><span class=lnt> 479
</span><span class=lnt> 480
</span><span class=lnt> 481
</span><span class=lnt> 482
</span><span class=lnt> 483
</span><span class=lnt> 484
</span><span class=lnt> 485
</span><span class=lnt> 486
</span><span class=lnt> 487
</span><span class=lnt> 488
</span><span class=lnt> 489
</span><span class=lnt> 490
</span><span class=lnt> 491
</span><span class=lnt> 492
</span><span class=lnt> 493
</span><span class=lnt> 494
</span><span class=lnt> 495
</span><span class=lnt> 496
</span><span class=lnt> 497
</span><span class=lnt> 498
</span><span class=lnt> 499
</span><span class=lnt> 500
</span><span class=lnt> 501
</span><span class=lnt> 502
</span><span class=lnt> 503
</span><span class=lnt> 504
</span><span class=lnt> 505
</span><span class=lnt> 506
</span><span class=lnt> 507
</span><span class=lnt> 508
</span><span class=lnt> 509
</span><span class=lnt> 510
</span><span class=lnt> 511
</span><span class=lnt> 512
</span><span class=lnt> 513
</span><span class=lnt> 514
</span><span class=lnt> 515
</span><span class=lnt> 516
</span><span class=lnt> 517
</span><span class=lnt> 518
</span><span class=lnt> 519
</span><span class=lnt> 520
</span><span class=lnt> 521
</span><span class=lnt> 522
</span><span class=lnt> 523
</span><span class=lnt> 524
</span><span class=lnt> 525
</span><span class=lnt> 526
</span><span class=lnt> 527
</span><span class=lnt> 528
</span><span class=lnt> 529
</span><span class=lnt> 530
</span><span class=lnt> 531
</span><span class=lnt> 532
</span><span class=lnt> 533
</span><span class=lnt> 534
</span><span class=lnt> 535
</span><span class=lnt> 536
</span><span class=lnt> 537
</span><span class=lnt> 538
</span><span class=lnt> 539
</span><span class=lnt> 540
</span><span class=lnt> 541
</span><span class=lnt> 542
</span><span class=lnt> 543
</span><span class=lnt> 544
</span><span class=lnt> 545
</span><span class=lnt> 546
</span><span class=lnt> 547
</span><span class=lnt> 548
</span><span class=lnt> 549
</span><span class=lnt> 550
</span><span class=lnt> 551
</span><span class=lnt> 552
</span><span class=lnt> 553
</span><span class=lnt> 554
</span><span class=lnt> 555
</span><span class=lnt> 556
</span><span class=lnt> 557
</span><span class=lnt> 558
</span><span class=lnt> 559
</span><span class=lnt> 560
</span><span class=lnt> 561
</span><span class=lnt> 562
</span><span class=lnt> 563
</span><span class=lnt> 564
</span><span class=lnt> 565
</span><span class=lnt> 566
</span><span class=lnt> 567
</span><span class=lnt> 568
</span><span class=lnt> 569
</span><span class=lnt> 570
</span><span class=lnt> 571
</span><span class=lnt> 572
</span><span class=lnt> 573
</span><span class=lnt> 574
</span><span class=lnt> 575
</span><span class=lnt> 576
</span><span class=lnt> 577
</span><span class=lnt> 578
</span><span class=lnt> 579
</span><span class=lnt> 580
</span><span class=lnt> 581
</span><span class=lnt> 582
</span><span class=lnt> 583
</span><span class=lnt> 584
</span><span class=lnt> 585
</span><span class=lnt> 586
</span><span class=lnt> 587
</span><span class=lnt> 588
</span><span class=lnt> 589
</span><span class=lnt> 590
</span><span class=lnt> 591
</span><span class=lnt> 592
</span><span class=lnt> 593
</span><span class=lnt> 594
</span><span class=lnt> 595
</span><span class=lnt> 596
</span><span class=lnt> 597
</span><span class=lnt> 598
</span><span class=lnt> 599
</span><span class=lnt> 600
</span><span class=lnt> 601
</span><span class=lnt> 602
</span><span class=lnt> 603
</span><span class=lnt> 604
</span><span class=lnt> 605
</span><span class=lnt> 606
</span><span class=lnt> 607
</span><span class=lnt> 608
</span><span class=lnt> 609
</span><span class=lnt> 610
</span><span class=lnt> 611
</span><span class=lnt> 612
</span><span class=lnt> 613
</span><span class=lnt> 614
</span><span class=lnt> 615
</span><span class=lnt> 616
</span><span class=lnt> 617
</span><span class=lnt> 618
</span><span class=lnt> 619
</span><span class=lnt> 620
</span><span class=lnt> 621
</span><span class=lnt> 622
</span><span class=lnt> 623
</span><span class=lnt> 624
</span><span class=lnt> 625
</span><span class=lnt> 626
</span><span class=lnt> 627
</span><span class=lnt> 628
</span><span class=lnt> 629
</span><span class=lnt> 630
</span><span class=lnt> 631
</span><span class=lnt> 632
</span><span class=lnt> 633
</span><span class=lnt> 634
</span><span class=lnt> 635
</span><span class=lnt> 636
</span><span class=lnt> 637
</span><span class=lnt> 638
</span><span class=lnt> 639
</span><span class=lnt> 640
</span><span class=lnt> 641
</span><span class=lnt> 642
</span><span class=lnt> 643
</span><span class=lnt> 644
</span><span class=lnt> 645
</span><span class=lnt> 646
</span><span class=lnt> 647
</span><span class=lnt> 648
</span><span class=lnt> 649
</span><span class=lnt> 650
</span><span class=lnt> 651
</span><span class=lnt> 652
</span><span class=lnt> 653
</span><span class=lnt> 654
</span><span class=lnt> 655
</span><span class=lnt> 656
</span><span class=lnt> 657
</span><span class=lnt> 658
</span><span class=lnt> 659
</span><span class=lnt> 660
</span><span class=lnt> 661
</span><span class=lnt> 662
</span><span class=lnt> 663
</span><span class=lnt> 664
</span><span class=lnt> 665
</span><span class=lnt> 666
</span><span class=lnt> 667
</span><span class=lnt> 668
</span><span class=lnt> 669
</span><span class=lnt> 670
</span><span class=lnt> 671
</span><span class=lnt> 672
</span><span class=lnt> 673
</span><span class=lnt> 674
</span><span class=lnt> 675
</span><span class=lnt> 676
</span><span class=lnt> 677
</span><span class=lnt> 678
</span><span class=lnt> 679
</span><span class=lnt> 680
</span><span class=lnt> 681
</span><span class=lnt> 682
</span><span class=lnt> 683
</span><span class=lnt> 684
</span><span class=lnt> 685
</span><span class=lnt> 686
</span><span class=lnt> 687
</span><span class=lnt> 688
</span><span class=lnt> 689
</span><span class=lnt> 690
</span><span class=lnt> 691
</span><span class=lnt> 692
</span><span class=lnt> 693
</span><span class=lnt> 694
</span><span class=lnt> 695
</span><span class=lnt> 696
</span><span class=lnt> 697
</span><span class=lnt> 698
</span><span class=lnt> 699
</span><span class=lnt> 700
</span><span class=lnt> 701
</span><span class=lnt> 702
</span><span class=lnt> 703
</span><span class=lnt> 704
</span><span class=lnt> 705
</span><span class=lnt> 706
</span><span class=lnt> 707
</span><span class=lnt> 708
</span><span class=lnt> 709
</span><span class=lnt> 710
</span><span class=lnt> 711
</span><span class=lnt> 712
</span><span class=lnt> 713
</span><span class=lnt> 714
</span><span class=lnt> 715
</span><span class=lnt> 716
</span><span class=lnt> 717
</span><span class=lnt> 718
</span><span class=lnt> 719
</span><span class=lnt> 720
</span><span class=lnt> 721
</span><span class=lnt> 722
</span><span class=lnt> 723
</span><span class=lnt> 724
</span><span class=lnt> 725
</span><span class=lnt> 726
</span><span class=lnt> 727
</span><span class=lnt> 728
</span><span class=lnt> 729
</span><span class=lnt> 730
</span><span class=lnt> 731
</span><span class=lnt> 732
</span><span class=lnt> 733
</span><span class=lnt> 734
</span><span class=lnt> 735
</span><span class=lnt> 736
</span><span class=lnt> 737
</span><span class=lnt> 738
</span><span class=lnt> 739
</span><span class=lnt> 740
</span><span class=lnt> 741
</span><span class=lnt> 742
</span><span class=lnt> 743
</span><span class=lnt> 744
</span><span class=lnt> 745
</span><span class=lnt> 746
</span><span class=lnt> 747
</span><span class=lnt> 748
</span><span class=lnt> 749
</span><span class=lnt> 750
</span><span class=lnt> 751
</span><span class=lnt> 752
</span><span class=lnt> 753
</span><span class=lnt> 754
</span><span class=lnt> 755
</span><span class=lnt> 756
</span><span class=lnt> 757
</span><span class=lnt> 758
</span><span class=lnt> 759
</span><span class=lnt> 760
</span><span class=lnt> 761
</span><span class=lnt> 762
</span><span class=lnt> 763
</span><span class=lnt> 764
</span><span class=lnt> 765
</span><span class=lnt> 766
</span><span class=lnt> 767
</span><span class=lnt> 768
</span><span class=lnt> 769
</span><span class=lnt> 770
</span><span class=lnt> 771
</span><span class=lnt> 772
</span><span class=lnt> 773
</span><span class=lnt> 774
</span><span class=lnt> 775
</span><span class=lnt> 776
</span><span class=lnt> 777
</span><span class=lnt> 778
</span><span class=lnt> 779
</span><span class=lnt> 780
</span><span class=lnt> 781
</span><span class=lnt> 782
</span><span class=lnt> 783
</span><span class=lnt> 784
</span><span class=lnt> 785
</span><span class=lnt> 786
</span><span class=lnt> 787
</span><span class=lnt> 788
</span><span class=lnt> 789
</span><span class=lnt> 790
</span><span class=lnt> 791
</span><span class=lnt> 792
</span><span class=lnt> 793
</span><span class=lnt> 794
</span><span class=lnt> 795
</span><span class=lnt> 796
</span><span class=lnt> 797
</span><span class=lnt> 798
</span><span class=lnt> 799
</span><span class=lnt> 800
</span><span class=lnt> 801
</span><span class=lnt> 802
</span><span class=lnt> 803
</span><span class=lnt> 804
</span><span class=lnt> 805
</span><span class=lnt> 806
</span><span class=lnt> 807
</span><span class=lnt> 808
</span><span class=lnt> 809
</span><span class=lnt> 810
</span><span class=lnt> 811
</span><span class=lnt> 812
</span><span class=lnt> 813
</span><span class=lnt> 814
</span><span class=lnt> 815
</span><span class=lnt> 816
</span><span class=lnt> 817
</span><span class=lnt> 818
</span><span class=lnt> 819
</span><span class=lnt> 820
</span><span class=lnt> 821
</span><span class=lnt> 822
</span><span class=lnt> 823
</span><span class=lnt> 824
</span><span class=lnt> 825
</span><span class=lnt> 826
</span><span class=lnt> 827
</span><span class=lnt> 828
</span><span class=lnt> 829
</span><span class=lnt> 830
</span><span class=lnt> 831
</span><span class=lnt> 832
</span><span class=lnt> 833
</span><span class=lnt> 834
</span><span class=lnt> 835
</span><span class=lnt> 836
</span><span class=lnt> 837
</span><span class=lnt> 838
</span><span class=lnt> 839
</span><span class=lnt> 840
</span><span class=lnt> 841
</span><span class=lnt> 842
</span><span class=lnt> 843
</span><span class=lnt> 844
</span><span class=lnt> 845
</span><span class=lnt> 846
</span><span class=lnt> 847
</span><span class=lnt> 848
</span><span class=lnt> 849
</span><span class=lnt> 850
</span><span class=lnt> 851
</span><span class=lnt> 852
</span><span class=lnt> 853
</span><span class=lnt> 854
</span><span class=lnt> 855
</span><span class=lnt> 856
</span><span class=lnt> 857
</span><span class=lnt> 858
</span><span class=lnt> 859
</span><span class=lnt> 860
</span><span class=lnt> 861
</span><span class=lnt> 862
</span><span class=lnt> 863
</span><span class=lnt> 864
</span><span class=lnt> 865
</span><span class=lnt> 866
</span><span class=lnt> 867
</span><span class=lnt> 868
</span><span class=lnt> 869
</span><span class=lnt> 870
</span><span class=lnt> 871
</span><span class=lnt> 872
</span><span class=lnt> 873
</span><span class=lnt> 874
</span><span class=lnt> 875
</span><span class=lnt> 876
</span><span class=lnt> 877
</span><span class=lnt> 878
</span><span class=lnt> 879
</span><span class=lnt> 880
</span><span class=lnt> 881
</span><span class=lnt> 882
</span><span class=lnt> 883
</span><span class=lnt> 884
</span><span class=lnt> 885
</span><span class=lnt> 886
</span><span class=lnt> 887
</span><span class=lnt> 888
</span><span class=lnt> 889
</span><span class=lnt> 890
</span><span class=lnt> 891
</span><span class=lnt> 892
</span><span class=lnt> 893
</span><span class=lnt> 894
</span><span class=lnt> 895
</span><span class=lnt> 896
</span><span class=lnt> 897
</span><span class=lnt> 898
</span><span class=lnt> 899
</span><span class=lnt> 900
</span><span class=lnt> 901
</span><span class=lnt> 902
</span><span class=lnt> 903
</span><span class=lnt> 904
</span><span class=lnt> 905
</span><span class=lnt> 906
</span><span class=lnt> 907
</span><span class=lnt> 908
</span><span class=lnt> 909
</span><span class=lnt> 910
</span><span class=lnt> 911
</span><span class=lnt> 912
</span><span class=lnt> 913
</span><span class=lnt> 914
</span><span class=lnt> 915
</span><span class=lnt> 916
</span><span class=lnt> 917
</span><span class=lnt> 918
</span><span class=lnt> 919
</span><span class=lnt> 920
</span><span class=lnt> 921
</span><span class=lnt> 922
</span><span class=lnt> 923
</span><span class=lnt> 924
</span><span class=lnt> 925
</span><span class=lnt> 926
</span><span class=lnt> 927
</span><span class=lnt> 928
</span><span class=lnt> 929
</span><span class=lnt> 930
</span><span class=lnt> 931
</span><span class=lnt> 932
</span><span class=lnt> 933
</span><span class=lnt> 934
</span><span class=lnt> 935
</span><span class=lnt> 936
</span><span class=lnt> 937
</span><span class=lnt> 938
</span><span class=lnt> 939
</span><span class=lnt> 940
</span><span class=lnt> 941
</span><span class=lnt> 942
</span><span class=lnt> 943
</span><span class=lnt> 944
</span><span class=lnt> 945
</span><span class=lnt> 946
</span><span class=lnt> 947
</span><span class=lnt> 948
</span><span class=lnt> 949
</span><span class=lnt> 950
</span><span class=lnt> 951
</span><span class=lnt> 952
</span><span class=lnt> 953
</span><span class=lnt> 954
</span><span class=lnt> 955
</span><span class=lnt> 956
</span><span class=lnt> 957
</span><span class=lnt> 958
</span><span class=lnt> 959
</span><span class=lnt> 960
</span><span class=lnt> 961
</span><span class=lnt> 962
</span><span class=lnt> 963
</span><span class=lnt> 964
</span><span class=lnt> 965
</span><span class=lnt> 966
</span><span class=lnt> 967
</span><span class=lnt> 968
</span><span class=lnt> 969
</span><span class=lnt> 970
</span><span class=lnt> 971
</span><span class=lnt> 972
</span><span class=lnt> 973
</span><span class=lnt> 974
</span><span class=lnt> 975
</span><span class=lnt> 976
</span><span class=lnt> 977
</span><span class=lnt> 978
</span><span class=lnt> 979
</span><span class=lnt> 980
</span><span class=lnt> 981
</span><span class=lnt> 982
</span><span class=lnt> 983
</span><span class=lnt> 984
</span><span class=lnt> 985
</span><span class=lnt> 986
</span><span class=lnt> 987
</span><span class=lnt> 988
</span><span class=lnt> 989
</span><span class=lnt> 990
</span><span class=lnt> 991
</span><span class=lnt> 992
</span><span class=lnt> 993
</span><span class=lnt> 994
</span><span class=lnt> 995
</span><span class=lnt> 996
</span><span class=lnt> 997
</span><span class=lnt> 998
</span><span class=lnt> 999
</span><span class=lnt>1000
</span><span class=lnt>1001
</span><span class=lnt>1002
</span><span class=lnt>1003
</span><span class=lnt>1004
</span><span class=lnt>1005
</span><span class=lnt>1006
</span><span class=lnt>1007
</span><span class=lnt>1008
</span><span class=lnt>1009
</span><span class=lnt>1010
</span><span class=lnt>1011
</span><span class=lnt>1012
</span><span class=lnt>1013
</span><span class=lnt>1014
</span><span class=lnt>1015
</span><span class=lnt>1016
</span><span class=lnt>1017
</span><span class=lnt>1018
</span><span class=lnt>1019
</span><span class=lnt>1020
</span><span class=lnt>1021
</span><span class=lnt>1022
</span><span class=lnt>1023
</span><span class=lnt>1024
</span><span class=lnt>1025
</span><span class=lnt>1026
</span><span class=lnt>1027
</span><span class=lnt>1028
</span><span class=lnt>1029
</span><span class=lnt>1030
</span><span class=lnt>1031
</span><span class=lnt>1032
</span><span class=lnt>1033
</span><span class=lnt>1034
</span><span class=lnt>1035
</span><span class=lnt>1036
</span><span class=lnt>1037
</span><span class=lnt>1038
</span><span class=lnt>1039
</span><span class=lnt>1040
</span><span class=lnt>1041
</span><span class=lnt>1042
</span><span class=lnt>1043
</span><span class=lnt>1044
</span><span class=lnt>1045
</span><span class=lnt>1046
</span><span class=lnt>1047
</span><span class=lnt>1048
</span><span class=lnt>1049
</span><span class=lnt>1050
</span><span class=lnt>1051
</span><span class=lnt>1052
</span><span class=lnt>1053
</span><span class=lnt>1054
</span><span class=lnt>1055
</span><span class=lnt>1056
</span><span class=lnt>1057
</span><span class=lnt>1058
</span><span class=lnt>1059
</span><span class=lnt>1060
</span><span class=lnt>1061
</span><span class=lnt>1062
</span><span class=lnt>1063
</span><span class=lnt>1064
</span><span class=lnt>1065
</span><span class=lnt>1066
</span><span class=lnt>1067
</span><span class=lnt>1068
</span><span class=lnt>1069
</span><span class=lnt>1070
</span><span class=lnt>1071
</span><span class=lnt>1072
</span><span class=lnt>1073
</span><span class=lnt>1074
</span><span class=lnt>1075
</span><span class=lnt>1076
</span><span class=lnt>1077
</span><span class=lnt>1078
</span><span class=lnt>1079
</span><span class=lnt>1080
</span><span class=lnt>1081
</span><span class=lnt>1082
</span><span class=lnt>1083
</span><span class=lnt>1084
</span><span class=lnt>1085
</span><span class=lnt>1086
</span><span class=lnt>1087
</span><span class=lnt>1088
</span><span class=lnt>1089
</span><span class=lnt>1090
</span><span class=lnt>1091
</span><span class=lnt>1092
</span><span class=lnt>1093
</span><span class=lnt>1094
</span><span class=lnt>1095
</span><span class=lnt>1096
</span><span class=lnt>1097
</span><span class=lnt>1098
</span><span class=lnt>1099
</span><span class=lnt>1100
</span><span class=lnt>1101
</span><span class=lnt>1102
</span><span class=lnt>1103
</span><span class=lnt>1104
</span><span class=lnt>1105
</span><span class=lnt>1106
</span><span class=lnt>1107
</span><span class=lnt>1108
</span><span class=lnt>1109
</span><span class=lnt>1110
</span><span class=lnt>1111
</span><span class=lnt>1112
</span><span class=lnt>1113
</span><span class=lnt>1114
</span><span class=lnt>1115
</span><span class=lnt>1116
</span><span class=lnt>1117
</span><span class=lnt>1118
</span><span class=lnt>1119
</span><span class=lnt>1120
</span><span class=lnt>1121
</span><span class=lnt>1122
</span><span class=lnt>1123
</span><span class=lnt>1124
</span><span class=lnt>1125
</span><span class=lnt>1126
</span><span class=lnt>1127
</span><span class=lnt>1128
</span><span class=lnt>1129
</span><span class=lnt>1130
</span><span class=lnt>1131
</span><span class=lnt>1132
</span><span class=lnt>1133
</span><span class=lnt>1134
</span><span class=lnt>1135
</span><span class=lnt>1136
</span><span class=lnt>1137
</span><span class=lnt>1138
</span><span class=lnt>1139
</span><span class=lnt>1140
</span><span class=lnt>1141
</span><span class=lnt>1142
</span><span class=lnt>1143
</span><span class=lnt>1144
</span><span class=lnt>1145
</span><span class=lnt>1146
</span><span class=lnt>1147
</span><span class=lnt>1148
</span><span class=lnt>1149
</span><span class=lnt>1150
</span><span class=lnt>1151
</span><span class=lnt>1152
</span><span class=lnt>1153
</span><span class=lnt>1154
</span><span class=lnt>1155
</span><span class=lnt>1156
</span><span class=lnt>1157
</span><span class=lnt>1158
</span><span class=lnt>1159
</span><span class=lnt>1160
</span><span class=lnt>1161
</span><span class=lnt>1162
</span><span class=lnt>1163
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>CryptoJS</span> <span class=o>=</span> <span class=nx>CryptoJS</span> <span class=o>||</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=p>(</span><span class=nx>u</span><span class=p>,</span> <span class=nx>p</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>d</span> <span class=o>=</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>            <span class=nx>l</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>lib</span> <span class=o>=</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>            <span class=nx>s</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>t</span> <span class=o>=</span> <span class=nx>l</span><span class=p>.</span><span class=nx>Base</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>extend</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>s</span><span class=p>.</span><span class=nx>prototype</span> <span class=o>=</span> <span class=k>this</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span> <span class=o>&amp;&amp;</span> <span class=nx>c</span><span class=p>.</span><span class=nx>mixIn</span><span class=p>(</span><span class=nx>a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>c</span><span class=p>.</span><span class=nx>hasOwnProperty</span><span class=p>(</span><span class=s2>&#34;init&#34;</span><span class=p>)</span> <span class=o>||</span> <span class=p>(</span><span class=nx>c</span><span class=p>.</span><span class=nx>init</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=nx>c</span><span class=p>.</span><span class=nx>$super</span><span class=p>.</span><span class=nx>init</span><span class=p>.</span><span class=nx>apply</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=nx>arguments</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>});</span>
</span></span><span class=line><span class=cl>                    <span class=nx>c</span><span class=p>.</span><span class=nx>init</span><span class=p>.</span><span class=nx>prototype</span> <span class=o>=</span> <span class=nx>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>c</span><span class=p>.</span><span class=nx>$super</span> <span class=o>=</span> <span class=k>this</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>c</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>create</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>extend</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span><span class=p>.</span><span class=nx>init</span><span class=p>.</span><span class=nx>apply</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>arguments</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>a</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>init</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>mixIn</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>c</span> <span class=k>in</span> <span class=nx>a</span><span class=p>)</span> <span class=nx>a</span><span class=p>.</span><span class=nx>hasOwnProperty</span><span class=p>(</span><span class=nx>c</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=k>this</span><span class=p>[</span><span class=nx>c</span><span class=p>]</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>c</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span><span class=p>.</span><span class=nx>hasOwnProperty</span><span class=p>(</span><span class=s2>&#34;toString&#34;</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>toString</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>toString</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>clone</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>init</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>extend</span><span class=p>(</span><span class=k>this</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>r</span> <span class=o>=</span> <span class=nx>l</span><span class=p>.</span><span class=nx>WordArray</span> <span class=o>=</span> <span class=nx>t</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>init</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>words</span> <span class=o>=</span> <span class=nx>a</span> <span class=o>||</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>sigBytes</span> <span class=o>=</span> <span class=nx>c</span> <span class=o>!=</span> <span class=nx>p</span> <span class=o>?</span> <span class=nx>c</span> <span class=o>:</span> <span class=mi>4</span> <span class=o>*</span> <span class=nx>a</span><span class=p>.</span><span class=nx>length</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>toString</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=p>(</span><span class=nx>a</span> <span class=o>||</span> <span class=nx>v</span><span class=p>).</span><span class=nx>stringify</span><span class=p>(</span><span class=k>this</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>concat</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>words</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>e</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>words</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>j</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>sigBytes</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>sigBytes</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>clamp</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=p>(</span><span class=nx>j</span> <span class=o>%</span> <span class=mi>4</span><span class=p>)</span> <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>k</span> <span class=o>&lt;</span> <span class=nx>a</span><span class=p>;</span> <span class=nx>k</span><span class=o>++</span><span class=p>)</span> <span class=nx>c</span><span class=p>[</span><span class=nx>j</span> <span class=o>+</span> <span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>2</span><span class=p>]</span> <span class=o>|=</span> <span class=p>(</span><span class=nx>e</span><span class=p>[</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>2</span><span class=p>]</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span> <span class=o>-</span> <span class=mi>8</span> <span class=o>*</span> <span class=p>(</span><span class=nx>k</span> <span class=o>%</span> <span class=mi>4</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>-</span> <span class=mi>8</span> <span class=o>*</span> <span class=p>((</span><span class=nx>j</span> <span class=o>+</span> <span class=nx>k</span><span class=p>)</span> <span class=o>%</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=mi>65535</span> <span class=o>&lt;</span> <span class=nx>e</span><span class=p>.</span><span class=nx>length</span><span class=p>)</span> <span class=k>for</span> <span class=p>(</span><span class=nx>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>k</span> <span class=o>&lt;</span> <span class=nx>a</span><span class=p>;</span> <span class=nx>k</span> <span class=o>+=</span> <span class=mi>4</span><span class=p>)</span> <span class=nx>c</span><span class=p>[</span><span class=nx>j</span> <span class=o>+</span> <span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=nx>e</span><span class=p>[</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=k>else</span> <span class=nx>c</span><span class=p>.</span><span class=nx>push</span><span class=p>.</span><span class=nx>apply</span><span class=p>(</span><span class=nx>c</span><span class=p>,</span> <span class=nx>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>sigBytes</span> <span class=o>+=</span> <span class=nx>a</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=k>this</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>clamp</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>words</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>c</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>sigBytes</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span><span class=p>[</span><span class=nx>c</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>2</span><span class=p>]</span> <span class=o>&amp;=</span> <span class=mi>4294967295</span> <span class=o>&lt;&lt;</span> <span class=mi>32</span> <span class=o>-</span> <span class=mi>8</span> <span class=o>*</span> <span class=p>(</span><span class=nx>c</span> <span class=o>%</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span><span class=p>.</span><span class=nx>length</span> <span class=o>=</span> <span class=nx>u</span><span class=p>.</span><span class=nx>ceil</span><span class=p>(</span><span class=nx>c</span> <span class=o>/</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>clone</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=nx>t</span><span class=p>.</span><span class=nx>clone</span><span class=p>.</span><span class=nx>call</span><span class=p>(</span><span class=k>this</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span><span class=p>.</span><span class=nx>words</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>words</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>a</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>random</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>e</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>e</span> <span class=o>&lt;</span> <span class=nx>a</span><span class=p>;</span> <span class=nx>e</span> <span class=o>+=</span> <span class=mi>4</span><span class=p>)</span> <span class=nx>c</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=mi>4294967296</span> <span class=o>*</span> <span class=nx>u</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span> <span class=o>|</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=k>new</span> <span class=nx>r</span><span class=p>.</span><span class=nx>init</span><span class=p>(</span><span class=nx>c</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}),</span>
</span></span><span class=line><span class=cl>            <span class=nx>w</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>enc</span> <span class=o>=</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>            <span class=nx>v</span> <span class=o>=</span> <span class=nx>w</span><span class=p>.</span><span class=nx>Hex</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>stringify</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>words</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>sigBytes</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>e</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>j</span> <span class=o>&lt;</span> <span class=nx>a</span><span class=p>;</span> <span class=nx>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=kd>var</span> <span class=nx>k</span> <span class=o>=</span> <span class=nx>c</span><span class=p>[</span><span class=nx>j</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>2</span><span class=p>]</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span> <span class=o>-</span> <span class=mi>8</span> <span class=o>*</span> <span class=p>(</span><span class=nx>j</span> <span class=o>%</span> <span class=mi>4</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=nx>e</span><span class=p>.</span><span class=nx>push</span><span class=p>((</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>4</span><span class=p>).</span><span class=nx>toString</span><span class=p>(</span><span class=mi>16</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                        <span class=nx>e</span><span class=p>.</span><span class=nx>push</span><span class=p>((</span><span class=nx>k</span> <span class=o>&amp;</span> <span class=mi>15</span><span class=p>).</span><span class=nx>toString</span><span class=p>(</span><span class=mi>16</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>e</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>parse</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>length</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>e</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>j</span> <span class=o>&lt;</span> <span class=nx>c</span><span class=p>;</span> <span class=nx>j</span> <span class=o>+=</span> <span class=mi>2</span><span class=p>)</span> <span class=nx>e</span><span class=p>[</span><span class=nx>j</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>3</span><span class=p>]</span> <span class=o>|=</span> <span class=nb>parseInt</span><span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>substr</span><span class=p>(</span><span class=nx>j</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span> <span class=mi>16</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>-</span> <span class=mi>4</span> <span class=o>*</span> <span class=p>(</span><span class=nx>j</span> <span class=o>%</span> <span class=mi>8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=k>new</span> <span class=nx>r</span><span class=p>.</span><span class=nx>init</span><span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>c</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>b</span> <span class=o>=</span> <span class=nx>w</span><span class=p>.</span><span class=nx>Latin1</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>stringify</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>words</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>sigBytes</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>e</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>j</span> <span class=o>&lt;</span> <span class=nx>a</span><span class=p>;</span> <span class=nx>j</span><span class=o>++</span><span class=p>)</span> <span class=nx>e</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nb>String</span><span class=p>.</span><span class=nx>fromCharCode</span><span class=p>(</span><span class=nx>c</span><span class=p>[</span><span class=nx>j</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>2</span><span class=p>]</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span> <span class=o>-</span> <span class=mi>8</span> <span class=o>*</span> <span class=p>(</span><span class=nx>j</span> <span class=o>%</span> <span class=mi>4</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>e</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>parse</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>length</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>e</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>j</span> <span class=o>&lt;</span> <span class=nx>c</span><span class=p>;</span> <span class=nx>j</span><span class=o>++</span><span class=p>)</span> <span class=nx>e</span><span class=p>[</span><span class=nx>j</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>2</span><span class=p>]</span> <span class=o>|=</span> <span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>charCodeAt</span><span class=p>(</span><span class=nx>j</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>-</span> <span class=mi>8</span> <span class=o>*</span> <span class=p>(</span><span class=nx>j</span> <span class=o>%</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=k>new</span> <span class=nx>r</span><span class=p>.</span><span class=nx>init</span><span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>x</span> <span class=o>=</span> <span class=nx>w</span><span class=p>.</span><span class=nx>Utf8</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>stringify</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>return</span> <span class=nb>decodeURIComponent</span><span class=p>(</span><span class=nx>escape</span><span class=p>(</span><span class=nx>b</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>a</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>c</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>throw</span> <span class=nb>Error</span><span class=p>(</span><span class=s2>&#34;Malformed UTF-8 data&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>parse</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>b</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>unescape</span><span class=p>(</span><span class=nb>encodeURIComponent</span><span class=p>(</span><span class=nx>a</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>q</span> <span class=o>=</span> <span class=nx>l</span><span class=p>.</span><span class=nx>BufferedBlockAlgorithm</span> <span class=o>=</span> <span class=nx>t</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>reset</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>i0x</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>r</span><span class=p>.</span><span class=nx>init</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>yx9o</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>zU9L</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;string&#34;</span> <span class=o>==</span> <span class=k>typeof</span> <span class=nx>a</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nx>a</span> <span class=o>=</span> <span class=nx>x</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>a</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>i0x</span><span class=p>.</span><span class=nx>concat</span><span class=p>(</span><span class=nx>a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>yx9o</span> <span class=o>+=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>sigBytes</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>mU5Z</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>i0x</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>e</span> <span class=o>=</span> <span class=nx>c</span><span class=p>.</span><span class=nx>words</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>j</span> <span class=o>=</span> <span class=nx>c</span><span class=p>.</span><span class=nx>sigBytes</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>k</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>blockSize</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>b</span> <span class=o>=</span> <span class=nx>j</span> <span class=o>/</span> <span class=p>(</span><span class=mi>4</span> <span class=o>*</span> <span class=nx>k</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                        <span class=nx>b</span> <span class=o>=</span> <span class=nx>a</span> <span class=o>?</span> <span class=nx>u</span><span class=p>.</span><span class=nx>ceil</span><span class=p>(</span><span class=nx>b</span><span class=p>)</span> <span class=o>:</span> <span class=nx>u</span><span class=p>.</span><span class=nx>max</span><span class=p>((</span><span class=nx>b</span> <span class=o>|</span> <span class=mi>0</span><span class=p>)</span> <span class=o>-</span> <span class=k>this</span><span class=p>.</span><span class=nx>WX9O</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span> <span class=o>=</span> <span class=nx>b</span> <span class=o>*</span> <span class=nx>k</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>j</span> <span class=o>=</span> <span class=nx>u</span><span class=p>.</span><span class=nx>min</span><span class=p>(</span><span class=mi>4</span> <span class=o>*</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>j</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>q</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>q</span> <span class=o>&lt;</span> <span class=nx>a</span><span class=p>;</span> <span class=nx>q</span> <span class=o>+=</span> <span class=nx>k</span><span class=p>)</span> <span class=k>this</span><span class=p>.</span><span class=nx>sA7t</span><span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>q</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                        <span class=nx>q</span> <span class=o>=</span> <span class=nx>e</span><span class=p>.</span><span class=nx>splice</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                        <span class=nx>c</span><span class=p>.</span><span class=nx>sigBytes</span> <span class=o>-=</span> <span class=nx>j</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=k>new</span> <span class=nx>r</span><span class=p>.</span><span class=nx>init</span><span class=p>(</span><span class=nx>q</span><span class=p>,</span> <span class=nx>j</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>clone</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=nx>t</span><span class=p>.</span><span class=nx>clone</span><span class=p>.</span><span class=nx>call</span><span class=p>(</span><span class=k>this</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span><span class=p>.</span><span class=nx>i0x</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>i0x</span><span class=p>.</span><span class=nx>clone</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>a</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>WX9O</span><span class=o>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=nx>l</span><span class=p>.</span><span class=nx>Hasher</span> <span class=o>=</span> <span class=nx>q</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>cfg</span><span class=o>:</span> <span class=nx>t</span><span class=p>.</span><span class=nx>extend</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=nx>init</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>cfg</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>cfg</span><span class=p>.</span><span class=nx>extend</span><span class=p>(</span><span class=nx>a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>reset</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>reset</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>q</span><span class=p>.</span><span class=nx>reset</span><span class=p>.</span><span class=nx>call</span><span class=p>(</span><span class=k>this</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>ma4e</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>update</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>zU9L</span><span class=p>(</span><span class=nx>a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>mU5Z</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=k>this</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>finalize</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>a</span> <span class=o>&amp;&amp;</span> <span class=k>this</span><span class=p>.</span><span class=nx>zU9L</span><span class=p>(</span><span class=nx>a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>oc5h</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>blockSize</span><span class=o>:</span> <span class=mi>16</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>mF4J</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=p>(</span><span class=k>new</span> <span class=nx>a</span><span class=p>.</span><span class=nx>init</span><span class=p>(</span><span class=nx>e</span><span class=p>)).</span><span class=nx>finalize</span><span class=p>(</span><span class=nx>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>yv9m</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=p>(</span><span class=k>new</span> <span class=nx>n</span><span class=p>.</span><span class=nx>HMAC</span><span class=p>.</span><span class=nx>init</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>e</span><span class=p>)).</span><span class=nx>finalize</span><span class=p>(</span><span class=nx>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>n</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>algo</span> <span class=o>=</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>d</span>
</span></span><span class=line><span class=cl>    <span class=p>}(</span><span class=nb>Math</span><span class=p>);</span> <span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>u</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>p</span> <span class=o>=</span> <span class=nx>u</span><span class=p>.</span><span class=nx>lib</span><span class=p>.</span><span class=nx>WordArray</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>u</span><span class=p>.</span><span class=nx>enc</span><span class=p>.</span><span class=nx>Base64</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>stringify</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>d</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kd>var</span> <span class=nx>l</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>words</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>p</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>sigBytes</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>t</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>bD1x</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>d</span><span class=p>.</span><span class=nx>clamp</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=nx>d</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>r</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>r</span> <span class=o>&lt;</span> <span class=nx>p</span><span class=p>;</span> <span class=nx>r</span> <span class=o>+=</span> <span class=mi>3</span><span class=p>)</span> <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>w</span> <span class=o>=</span> <span class=p>(</span><span class=nx>l</span><span class=p>[</span><span class=nx>r</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>2</span><span class=p>]</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span> <span class=o>-</span> <span class=mi>8</span> <span class=o>*</span> <span class=p>(</span><span class=nx>r</span> <span class=o>%</span> <span class=mi>4</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span> <span class=o>|</span> <span class=p>(</span><span class=nx>l</span><span class=p>[</span><span class=nx>r</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>2</span><span class=p>]</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span> <span class=o>-</span> <span class=mi>8</span> <span class=o>*</span> <span class=p>((</span><span class=nx>r</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=mi>4</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span> <span class=o>|</span> <span class=nx>l</span><span class=p>[</span><span class=nx>r</span> <span class=o>+</span> <span class=mi>2</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>2</span><span class=p>]</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span> <span class=o>-</span> <span class=mi>8</span> <span class=o>*</span> <span class=p>((</span><span class=nx>r</span> <span class=o>+</span> <span class=mi>2</span><span class=p>)</span> <span class=o>%</span> <span class=mi>4</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>,</span> <span class=nx>v</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>4</span> <span class=o>&gt;</span> <span class=nx>v</span> <span class=o>&amp;&amp;</span> <span class=nx>r</span> <span class=o>+</span> <span class=p>.</span><span class=mi>75</span> <span class=o>*</span> <span class=nx>v</span> <span class=o>&lt;</span> <span class=nx>p</span><span class=p>;</span> <span class=nx>v</span><span class=o>++</span><span class=p>)</span> <span class=nx>d</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>t</span><span class=p>.</span><span class=nx>charAt</span><span class=p>(</span><span class=nx>w</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>6</span> <span class=o>*</span> <span class=p>(</span><span class=mi>3</span> <span class=o>-</span> <span class=nx>v</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>63</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>l</span> <span class=o>=</span> <span class=nx>t</span><span class=p>.</span><span class=nx>charAt</span><span class=p>(</span><span class=mi>64</span><span class=p>))</span> <span class=k>for</span> <span class=p>(;</span> <span class=nx>d</span><span class=p>.</span><span class=nx>length</span> <span class=o>%</span> <span class=mi>4</span><span class=p>;)</span> <span class=nx>d</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>l</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>d</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>parse</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>d</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kd>var</span> <span class=nx>l</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>length</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>s</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>bD1x</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>t</span> <span class=o>=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>charAt</span><span class=p>(</span><span class=mi>64</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>t</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nx>t</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>t</span><span class=p>),</span> <span class=o>-</span><span class=mi>1</span> <span class=o>!=</span> <span class=nx>t</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nx>l</span> <span class=o>=</span> <span class=nx>t</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>t</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>r</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>w</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>w</span> <span class=o>&lt;</span> <span class=nx>l</span><span class=p>;</span> <span class=nx>w</span><span class=o>++</span><span class=p>)</span> <span class=k>if</span> <span class=p>(</span><span class=nx>w</span> <span class=o>%</span> <span class=mi>4</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kd>var</span> <span class=nx>v</span> <span class=o>=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>d</span><span class=p>.</span><span class=nx>charAt</span><span class=p>(</span><span class=nx>w</span> <span class=o>-</span> <span class=mi>1</span><span class=p>))</span> <span class=o>&lt;&lt;</span> <span class=mi>2</span> <span class=o>*</span> <span class=p>(</span><span class=nx>w</span> <span class=o>%</span> <span class=mi>4</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                        <span class=nx>b</span> <span class=o>=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>d</span><span class=p>.</span><span class=nx>charAt</span><span class=p>(</span><span class=nx>w</span><span class=p>))</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>6</span> <span class=o>-</span> <span class=mi>2</span> <span class=o>*</span> <span class=p>(</span><span class=nx>w</span> <span class=o>%</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>t</span><span class=p>[</span><span class=nx>r</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>2</span><span class=p>]</span> <span class=o>|=</span> <span class=p>(</span><span class=nx>v</span> <span class=o>|</span> <span class=nx>b</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>-</span> <span class=mi>8</span> <span class=o>*</span> <span class=p>(</span><span class=nx>r</span> <span class=o>%</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>r</span><span class=o>++</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>p</span><span class=p>.</span><span class=nx>create</span><span class=p>(</span><span class=nx>t</span><span class=p>,</span> <span class=nx>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>bD1x</span><span class=o>:</span> <span class=s2>&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>})();</span> <span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>u</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>function</span> <span class=nx>p</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>n</span><span class=p>,</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>j</span><span class=p>,</span> <span class=nx>k</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>b</span> <span class=o>=</span> <span class=nx>b</span> <span class=o>+</span> <span class=p>(</span><span class=nx>n</span> <span class=o>&amp;</span> <span class=nx>a</span> <span class=o>|</span> <span class=o>~</span><span class=nx>n</span> <span class=o>&amp;</span> <span class=nx>c</span><span class=p>)</span> <span class=o>+</span> <span class=nx>e</span> <span class=o>+</span> <span class=nx>k</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>(</span><span class=nx>b</span> <span class=o>&lt;&lt;</span> <span class=nx>j</span> <span class=o>|</span> <span class=nx>b</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>32</span> <span class=o>-</span> <span class=nx>j</span><span class=p>)</span> <span class=o>+</span> <span class=nx>n</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=kd>function</span> <span class=nx>d</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>n</span><span class=p>,</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>j</span><span class=p>,</span> <span class=nx>k</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>b</span> <span class=o>=</span> <span class=nx>b</span> <span class=o>+</span> <span class=p>(</span><span class=nx>n</span> <span class=o>&amp;</span> <span class=nx>c</span> <span class=o>|</span> <span class=nx>a</span> <span class=o>&amp;</span> <span class=o>~</span><span class=nx>c</span><span class=p>)</span> <span class=o>+</span> <span class=nx>e</span> <span class=o>+</span> <span class=nx>k</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>(</span><span class=nx>b</span> <span class=o>&lt;&lt;</span> <span class=nx>j</span> <span class=o>|</span> <span class=nx>b</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>32</span> <span class=o>-</span> <span class=nx>j</span><span class=p>)</span> <span class=o>+</span> <span class=nx>n</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=kd>function</span> <span class=nx>l</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>n</span><span class=p>,</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>j</span><span class=p>,</span> <span class=nx>k</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>b</span> <span class=o>=</span> <span class=nx>b</span> <span class=o>+</span> <span class=p>(</span><span class=nx>n</span> <span class=o>^</span> <span class=nx>a</span> <span class=o>^</span> <span class=nx>c</span><span class=p>)</span> <span class=o>+</span> <span class=nx>e</span> <span class=o>+</span> <span class=nx>k</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>(</span><span class=nx>b</span> <span class=o>&lt;&lt;</span> <span class=nx>j</span> <span class=o>|</span> <span class=nx>b</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>32</span> <span class=o>-</span> <span class=nx>j</span><span class=p>)</span> <span class=o>+</span> <span class=nx>n</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=kd>function</span> <span class=nx>s</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>n</span><span class=p>,</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>j</span><span class=p>,</span> <span class=nx>k</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>b</span> <span class=o>=</span> <span class=nx>b</span> <span class=o>+</span> <span class=p>(</span><span class=nx>a</span> <span class=o>^</span> <span class=p>(</span><span class=nx>n</span> <span class=o>|</span> <span class=o>~</span><span class=nx>c</span><span class=p>))</span> <span class=o>+</span> <span class=nx>e</span> <span class=o>+</span> <span class=nx>k</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>(</span><span class=nx>b</span> <span class=o>&lt;&lt;</span> <span class=nx>j</span> <span class=o>|</span> <span class=nx>b</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>32</span> <span class=o>-</span> <span class=nx>j</span><span class=p>)</span> <span class=o>+</span> <span class=nx>n</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>t</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>r</span> <span class=o>=</span> <span class=nx>t</span><span class=p>.</span><span class=nx>lib</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>w</span> <span class=o>=</span> <span class=nx>r</span><span class=p>.</span><span class=nx>WordArray</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>v</span> <span class=o>=</span> <span class=nx>r</span><span class=p>.</span><span class=nx>Hasher</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>r</span> <span class=o>=</span> <span class=nx>t</span><span class=p>.</span><span class=nx>algo</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>b</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>x</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>64</span> <span class=o>&gt;</span> <span class=nx>x</span><span class=p>;</span> <span class=nx>x</span><span class=o>++</span><span class=p>)</span> <span class=nx>b</span><span class=p>[</span><span class=nx>x</span><span class=p>]</span> <span class=o>=</span> <span class=mi>4294967296</span> <span class=o>*</span> <span class=nx>u</span><span class=p>.</span><span class=nx>abs</span><span class=p>(</span><span class=nx>u</span><span class=p>.</span><span class=nx>sin</span><span class=p>(</span><span class=nx>x</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))</span> <span class=o>|</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>r</span> <span class=o>=</span> <span class=nx>r</span><span class=p>.</span><span class=nx>MD5</span> <span class=o>=</span> <span class=nx>v</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>ma4e</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>cU1x</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>w</span><span class=p>.</span><span class=nx>init</span><span class=p>([</span><span class=mi>1732584193</span><span class=p>,</span> <span class=mi>4023233417</span><span class=p>,</span> <span class=mi>2562383102</span><span class=p>,</span> <span class=mi>271733878</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>sA7t</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>q</span><span class=p>,</span> <span class=nx>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>16</span> <span class=o>&gt;</span> <span class=nx>a</span><span class=p>;</span> <span class=nx>a</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>n</span> <span class=o>+</span> <span class=nx>a</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>e</span> <span class=o>=</span> <span class=nx>q</span><span class=p>[</span><span class=nx>c</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=nx>q</span><span class=p>[</span><span class=nx>c</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=nx>e</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span> <span class=o>|</span> <span class=nx>e</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>16711935</span> <span class=o>|</span> <span class=p>(</span><span class=nx>e</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>|</span> <span class=nx>e</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>4278255360</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>cU1x</span><span class=p>.</span><span class=nx>words</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>c</span> <span class=o>=</span> <span class=nx>q</span><span class=p>[</span><span class=nx>n</span> <span class=o>+</span> <span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>e</span> <span class=o>=</span> <span class=nx>q</span><span class=p>[</span><span class=nx>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>j</span> <span class=o>=</span> <span class=nx>q</span><span class=p>[</span><span class=nx>n</span> <span class=o>+</span> <span class=mi>2</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>k</span> <span class=o>=</span> <span class=nx>q</span><span class=p>[</span><span class=nx>n</span> <span class=o>+</span> <span class=mi>3</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>z</span> <span class=o>=</span> <span class=nx>q</span><span class=p>[</span><span class=nx>n</span> <span class=o>+</span> <span class=mi>4</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>r</span> <span class=o>=</span> <span class=nx>q</span><span class=p>[</span><span class=nx>n</span> <span class=o>+</span> <span class=mi>5</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>t</span> <span class=o>=</span> <span class=nx>q</span><span class=p>[</span><span class=nx>n</span> <span class=o>+</span> <span class=mi>6</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>w</span> <span class=o>=</span> <span class=nx>q</span><span class=p>[</span><span class=nx>n</span> <span class=o>+</span> <span class=mi>7</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>v</span> <span class=o>=</span> <span class=nx>q</span><span class=p>[</span><span class=nx>n</span> <span class=o>+</span> <span class=mi>8</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>A</span> <span class=o>=</span> <span class=nx>q</span><span class=p>[</span><span class=nx>n</span> <span class=o>+</span> <span class=mi>9</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>B</span> <span class=o>=</span> <span class=nx>q</span><span class=p>[</span><span class=nx>n</span> <span class=o>+</span> <span class=mi>10</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>C</span> <span class=o>=</span> <span class=nx>q</span><span class=p>[</span><span class=nx>n</span> <span class=o>+</span> <span class=mi>11</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>u</span> <span class=o>=</span> <span class=nx>q</span><span class=p>[</span><span class=nx>n</span> <span class=o>+</span> <span class=mi>12</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>D</span> <span class=o>=</span> <span class=nx>q</span><span class=p>[</span><span class=nx>n</span> <span class=o>+</span> <span class=mi>13</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>E</span> <span class=o>=</span> <span class=nx>q</span><span class=p>[</span><span class=nx>n</span> <span class=o>+</span> <span class=mi>14</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>x</span> <span class=o>=</span> <span class=nx>q</span><span class=p>[</span><span class=nx>n</span> <span class=o>+</span> <span class=mi>15</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>f</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>m</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>g</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>h</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>f</span> <span class=o>=</span> <span class=nx>p</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>0</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>h</span> <span class=o>=</span> <span class=nx>p</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>1</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>g</span> <span class=o>=</span> <span class=nx>p</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>j</span><span class=p>,</span> <span class=mi>17</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>m</span> <span class=o>=</span> <span class=nx>p</span><span class=p>(</span><span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>k</span><span class=p>,</span> <span class=mi>22</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>3</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>f</span> <span class=o>=</span> <span class=nx>p</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>z</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>4</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>h</span> <span class=o>=</span> <span class=nx>p</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>r</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>5</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>g</span> <span class=o>=</span> <span class=nx>p</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>t</span><span class=p>,</span> <span class=mi>17</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>6</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>m</span> <span class=o>=</span> <span class=nx>p</span><span class=p>(</span><span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>w</span><span class=p>,</span> <span class=mi>22</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>7</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>f</span> <span class=o>=</span> <span class=nx>p</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>v</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>8</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>h</span> <span class=o>=</span> <span class=nx>p</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>A</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>9</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>g</span> <span class=o>=</span> <span class=nx>p</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>B</span><span class=p>,</span> <span class=mi>17</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>10</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>m</span> <span class=o>=</span> <span class=nx>p</span><span class=p>(</span><span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>C</span><span class=p>,</span> <span class=mi>22</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>11</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>f</span> <span class=o>=</span> <span class=nx>p</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>u</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>12</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>h</span> <span class=o>=</span> <span class=nx>p</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>D</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>13</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>g</span> <span class=o>=</span> <span class=nx>p</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>E</span><span class=p>,</span> <span class=mi>17</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>14</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>m</span> <span class=o>=</span> <span class=nx>p</span><span class=p>(</span><span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>x</span><span class=p>,</span> <span class=mi>22</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>15</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>f</span> <span class=o>=</span> <span class=nx>d</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>16</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>h</span> <span class=o>=</span> <span class=nx>d</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>t</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>17</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>g</span> <span class=o>=</span> <span class=nx>d</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>C</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>18</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>m</span> <span class=o>=</span> <span class=nx>d</span><span class=p>(</span><span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>19</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>f</span> <span class=o>=</span> <span class=nx>d</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>r</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>20</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>h</span> <span class=o>=</span> <span class=nx>d</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>B</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>21</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>g</span> <span class=o>=</span> <span class=nx>d</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>x</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>22</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>m</span> <span class=o>=</span> <span class=nx>d</span><span class=p>(</span><span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>z</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>23</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>f</span> <span class=o>=</span> <span class=nx>d</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>A</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>24</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>h</span> <span class=o>=</span> <span class=nx>d</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>E</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>25</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>g</span> <span class=o>=</span> <span class=nx>d</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>k</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>26</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>m</span> <span class=o>=</span> <span class=nx>d</span><span class=p>(</span><span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>v</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>27</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>f</span> <span class=o>=</span> <span class=nx>d</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>D</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>28</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>h</span> <span class=o>=</span> <span class=nx>d</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>j</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>29</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>g</span> <span class=o>=</span> <span class=nx>d</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>w</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>30</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>m</span> <span class=o>=</span> <span class=nx>d</span><span class=p>(</span><span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>u</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>31</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>f</span> <span class=o>=</span> <span class=nx>l</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>r</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>32</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>h</span> <span class=o>=</span> <span class=nx>l</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>v</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>33</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>g</span> <span class=o>=</span> <span class=nx>l</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>C</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>34</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>m</span> <span class=o>=</span> <span class=nx>l</span><span class=p>(</span><span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>E</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>35</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>f</span> <span class=o>=</span> <span class=nx>l</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>36</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>h</span> <span class=o>=</span> <span class=nx>l</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>z</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>37</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>g</span> <span class=o>=</span> <span class=nx>l</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>w</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>38</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>m</span> <span class=o>=</span> <span class=nx>l</span><span class=p>(</span><span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>B</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>39</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>f</span> <span class=o>=</span> <span class=nx>l</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>D</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>40</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>h</span> <span class=o>=</span> <span class=nx>l</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>41</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>g</span> <span class=o>=</span> <span class=nx>l</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>k</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>42</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>m</span> <span class=o>=</span> <span class=nx>l</span><span class=p>(</span><span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>t</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>43</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>f</span> <span class=o>=</span> <span class=nx>l</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>A</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>44</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>h</span> <span class=o>=</span> <span class=nx>l</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>u</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>45</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>g</span> <span class=o>=</span> <span class=nx>l</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>x</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>46</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>m</span> <span class=o>=</span> <span class=nx>l</span><span class=p>(</span><span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>j</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>47</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>f</span> <span class=o>=</span> <span class=nx>s</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>48</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>h</span> <span class=o>=</span> <span class=nx>s</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>w</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>49</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>g</span> <span class=o>=</span> <span class=nx>s</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>E</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>50</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>m</span> <span class=o>=</span> <span class=nx>s</span><span class=p>(</span><span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>r</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>51</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>f</span> <span class=o>=</span> <span class=nx>s</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>u</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>52</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>h</span> <span class=o>=</span> <span class=nx>s</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>k</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>53</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>g</span> <span class=o>=</span> <span class=nx>s</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>B</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>54</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>m</span> <span class=o>=</span> <span class=nx>s</span><span class=p>(</span><span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>55</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>f</span> <span class=o>=</span> <span class=nx>s</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>v</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>56</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>h</span> <span class=o>=</span> <span class=nx>s</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>x</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>57</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>g</span> <span class=o>=</span> <span class=nx>s</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>t</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>58</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>m</span> <span class=o>=</span> <span class=nx>s</span><span class=p>(</span><span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>D</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>59</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>f</span> <span class=o>=</span> <span class=nx>s</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>z</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>60</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>h</span> <span class=o>=</span> <span class=nx>s</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>C</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>61</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>g</span> <span class=o>=</span> <span class=nx>s</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>j</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>62</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>m</span> <span class=o>=</span> <span class=nx>s</span><span class=p>(</span><span class=nx>m</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>A</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=nx>b</span><span class=p>[</span><span class=mi>63</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>                <span class=nx>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=nx>f</span> <span class=o>|</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>a</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=nx>m</span> <span class=o>|</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>a</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=nx>g</span> <span class=o>|</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>+</span> <span class=nx>h</span> <span class=o>|</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>oc5h</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>i0x</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>n</span> <span class=o>=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>words</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span> <span class=o>=</span> <span class=mi>8</span> <span class=o>*</span> <span class=k>this</span><span class=p>.</span><span class=nx>yx9o</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>c</span> <span class=o>=</span> <span class=mi>8</span> <span class=o>*</span> <span class=nx>b</span><span class=p>.</span><span class=nx>sigBytes</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>n</span><span class=p>[</span><span class=nx>c</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>5</span><span class=p>]</span> <span class=o>|=</span> <span class=mi>128</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>-</span> <span class=nx>c</span> <span class=o>%</span> <span class=mi>32</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=kd>var</span> <span class=nx>e</span> <span class=o>=</span> <span class=nx>u</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nx>a</span> <span class=o>/</span> <span class=mi>4294967296</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>n</span><span class=p>[(</span><span class=nx>c</span> <span class=o>+</span> <span class=mi>64</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>9</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>+</span> <span class=mi>15</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=nx>e</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span> <span class=o>|</span> <span class=nx>e</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>16711935</span> <span class=o>|</span> <span class=p>(</span><span class=nx>e</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>|</span> <span class=nx>e</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>4278255360</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>n</span><span class=p>[(</span><span class=nx>c</span> <span class=o>+</span> <span class=mi>64</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>9</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>)</span> <span class=o>+</span> <span class=mi>14</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=nx>a</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span> <span class=o>|</span> <span class=nx>a</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>16711935</span> <span class=o>|</span> <span class=p>(</span><span class=nx>a</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>|</span> <span class=nx>a</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>4278255360</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>b</span><span class=p>.</span><span class=nx>sigBytes</span> <span class=o>=</span> <span class=mi>4</span> <span class=o>*</span> <span class=p>(</span><span class=nx>n</span><span class=p>.</span><span class=nx>length</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>mU5Z</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=nx>b</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>cU1x</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>n</span> <span class=o>=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>words</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=p>(</span><span class=nx>a</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>4</span> <span class=o>&gt;</span> <span class=nx>a</span><span class=p>;</span> <span class=nx>a</span><span class=o>++</span><span class=p>)</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>n</span><span class=p>[</span><span class=nx>a</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=nx>n</span><span class=p>[</span><span class=nx>a</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=nx>c</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span> <span class=o>|</span> <span class=nx>c</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>16711935</span> <span class=o>|</span> <span class=p>(</span><span class=nx>c</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>|</span> <span class=nx>c</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mi>4278255360</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>clone</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=nx>v</span><span class=p>.</span><span class=nx>clone</span><span class=p>.</span><span class=nx>call</span><span class=p>(</span><span class=k>this</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>b</span><span class=p>.</span><span class=nx>cU1x</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>cU1x</span><span class=p>.</span><span class=nx>clone</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=nx>t</span><span class=p>.</span><span class=nx>MD5</span> <span class=o>=</span> <span class=nx>v</span><span class=p>.</span><span class=nx>mF4J</span><span class=p>(</span><span class=nx>r</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>t</span><span class=p>.</span><span class=nx>HmacMD5</span> <span class=o>=</span> <span class=nx>v</span><span class=p>.</span><span class=nx>yv9m</span><span class=p>(</span><span class=nx>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})(</span><span class=nb>Math</span><span class=p>);</span> <span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>u</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>p</span> <span class=o>=</span> <span class=nx>u</span><span class=p>.</span><span class=nx>lib</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>d</span> <span class=o>=</span> <span class=nx>p</span><span class=p>.</span><span class=nx>Base</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>l</span> <span class=o>=</span> <span class=nx>p</span><span class=p>.</span><span class=nx>WordArray</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>p</span> <span class=o>=</span> <span class=nx>u</span><span class=p>.</span><span class=nx>algo</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>s</span> <span class=o>=</span> <span class=nx>p</span><span class=p>.</span><span class=nx>EvpKDF</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>cfg</span><span class=o>:</span> <span class=nx>d</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=nx>keySize</span><span class=o>:</span> <span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>hasher</span><span class=o>:</span> <span class=nx>p</span><span class=p>.</span><span class=nx>MD5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>iterations</span><span class=o>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=p>}),</span>
</span></span><span class=line><span class=cl>                <span class=nx>init</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>d</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>cfg</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>cfg</span><span class=p>.</span><span class=nx>extend</span><span class=p>(</span><span class=nx>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>compute</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>r</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>p</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>cfg</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>s</span> <span class=o>=</span> <span class=nx>p</span><span class=p>.</span><span class=nx>hasher</span><span class=p>.</span><span class=nx>create</span><span class=p>(),</span> <span class=nx>b</span> <span class=o>=</span> <span class=nx>l</span><span class=p>.</span><span class=nx>create</span><span class=p>(),</span> <span class=nx>u</span> <span class=o>=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>words</span><span class=p>,</span> <span class=nx>q</span> <span class=o>=</span> <span class=nx>p</span><span class=p>.</span><span class=nx>keySize</span><span class=p>,</span> <span class=nx>p</span> <span class=o>=</span> <span class=nx>p</span><span class=p>.</span><span class=nx>iterations</span><span class=p>;</span> <span class=nx>u</span><span class=p>.</span><span class=nx>length</span> <span class=o>&lt;</span> <span class=nx>q</span><span class=p>;)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=nx>n</span> <span class=o>&amp;&amp;</span> <span class=nx>s</span><span class=p>.</span><span class=nx>update</span><span class=p>(</span><span class=nx>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                        <span class=kd>var</span> <span class=nx>n</span> <span class=o>=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>update</span><span class=p>(</span><span class=nx>d</span><span class=p>).</span><span class=nx>finalize</span><span class=p>(</span><span class=nx>r</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                        <span class=nx>s</span><span class=p>.</span><span class=nx>reset</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                        <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>a</span> <span class=o>&lt;</span> <span class=nx>p</span><span class=p>;</span> <span class=nx>a</span><span class=o>++</span><span class=p>)</span> <span class=nx>n</span> <span class=o>=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>finalize</span><span class=p>(</span><span class=nx>n</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                            <span class=nx>s</span><span class=p>.</span><span class=nx>reset</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                        <span class=nx>b</span><span class=p>.</span><span class=nx>concat</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=nx>b</span><span class=p>.</span><span class=nx>sigBytes</span> <span class=o>=</span> <span class=mi>4</span> <span class=o>*</span> <span class=nx>q</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=nx>u</span><span class=p>.</span><span class=nx>EvpKDF</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>p</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>s</span><span class=p>.</span><span class=nx>create</span><span class=p>(</span><span class=nx>p</span><span class=p>).</span><span class=nx>compute</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>})();</span>
</span></span><span class=line><span class=cl><span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>lib</span><span class=p>.</span><span class=nx>Cipher</span> <span class=o>||</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=p>(</span><span class=nx>u</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>p</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>d</span> <span class=o>=</span> <span class=nx>p</span><span class=p>.</span><span class=nx>lib</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>l</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>Base</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>s</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>WordArray</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>t</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>BufferedBlockAlgorithm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>r</span> <span class=o>=</span> <span class=nx>p</span><span class=p>.</span><span class=nx>enc</span><span class=p>.</span><span class=nx>Base64</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>w</span> <span class=o>=</span> <span class=nx>p</span><span class=p>.</span><span class=nx>algo</span><span class=p>.</span><span class=nx>EvpKDF</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>v</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>Cipher</span> <span class=o>=</span> <span class=nx>t</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>cfg</span><span class=o>:</span> <span class=nx>l</span><span class=p>.</span><span class=nx>extend</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=nx>createEncryptor</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>create</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>Hv1x</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>createDecryptor</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>create</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>brA6u</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>init</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>cfg</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>cfg</span><span class=p>.</span><span class=nx>extend</span><span class=p>(</span><span class=nx>b</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>WW9N</span> <span class=o>=</span> <span class=nx>e</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>J0x</span> <span class=o>=</span> <span class=nx>a</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>reset</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>reset</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>t</span><span class=p>.</span><span class=nx>reset</span><span class=p>.</span><span class=nx>call</span><span class=p>(</span><span class=k>this</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>ma4e</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>process</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>zU9L</span><span class=p>(</span><span class=nx>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>mU5Z</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>finalize</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>e</span> <span class=o>&amp;&amp;</span> <span class=k>this</span><span class=p>.</span><span class=nx>zU9L</span><span class=p>(</span><span class=nx>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>oc5h</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>keySize</span><span class=o>:</span> <span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>ivSize</span><span class=o>:</span> <span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>Hv1x</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>brA6u</span><span class=o>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>mF4J</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=nx>encrypt</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>k</span><span class=p>,</span> <span class=nx>d</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                            <span class=k>return</span> <span class=p>(</span><span class=s2>&#34;string&#34;</span> <span class=o>==</span> <span class=k>typeof</span> <span class=nx>k</span> <span class=o>?</span> <span class=nx>c</span> <span class=o>:</span> <span class=nx>a</span><span class=p>).</span><span class=nx>encrypt</span><span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>k</span><span class=p>,</span> <span class=nx>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>},</span>
</span></span><span class=line><span class=cl>                        <span class=nx>decrypt</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>k</span><span class=p>,</span> <span class=nx>d</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                            <span class=k>return</span> <span class=p>(</span><span class=s2>&#34;string&#34;</span> <span class=o>==</span> <span class=k>typeof</span> <span class=nx>k</span> <span class=o>?</span> <span class=nx>c</span> <span class=o>:</span> <span class=nx>a</span><span class=p>).</span><span class=nx>decrypt</span><span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>k</span><span class=p>,</span> <span class=nx>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span><span class=p>.</span><span class=nx>StreamCipher</span> <span class=o>=</span> <span class=nx>v</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>oc5h</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>mU5Z</span><span class=p>(</span><span class=o>!</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>blockSize</span><span class=o>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=nx>p</span><span class=p>.</span><span class=nx>mode</span> <span class=o>=</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>            <span class=nx>x</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>sC7v</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>c</span> <span class=o>?</span> <span class=k>this</span><span class=p>.</span><span class=nx>sC7v</span> <span class=o>=</span> <span class=nx>u</span> <span class=o>:</span> <span class=nx>c</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>DY0x</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>d</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>d</span> <span class=o>&lt;</span> <span class=nx>b</span><span class=p>;</span> <span class=nx>d</span><span class=o>++</span><span class=p>)</span> <span class=nx>e</span><span class=p>[</span><span class=nx>a</span> <span class=o>+</span> <span class=nx>d</span><span class=p>]</span> <span class=o>^=</span> <span class=nx>c</span><span class=p>[</span><span class=nx>d</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>q</span> <span class=o>=</span> <span class=p>(</span><span class=nx>d</span><span class=p>.</span><span class=nx>BlockCipherMode</span> <span class=o>=</span> <span class=nx>l</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>createEncryptor</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>Encryptor</span><span class=p>.</span><span class=nx>create</span><span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>createDecryptor</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>Decryptor</span><span class=p>.</span><span class=nx>create</span><span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>init</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>ul7e</span> <span class=o>=</span> <span class=nx>e</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>sC7v</span> <span class=o>=</span> <span class=nx>a</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>})).</span><span class=nx>extend</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=nx>q</span><span class=p>.</span><span class=nx>Encryptor</span> <span class=o>=</span> <span class=nx>q</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>processBlock</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>ul7e</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>c</span> <span class=o>=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>blockSize</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>x</span><span class=p>.</span><span class=nx>call</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>c</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>b</span><span class=p>.</span><span class=nx>encryptBlock</span><span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>DY0x</span> <span class=o>=</span> <span class=nx>e</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>a</span> <span class=o>+</span> <span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=nx>q</span><span class=p>.</span><span class=nx>Decryptor</span> <span class=o>=</span> <span class=nx>q</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>processBlock</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>ul7e</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>c</span> <span class=o>=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>blockSize</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>d</span> <span class=o>=</span> <span class=nx>e</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>a</span> <span class=o>+</span> <span class=nx>c</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>b</span><span class=p>.</span><span class=nx>decryptBlock</span><span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>x</span><span class=p>.</span><span class=nx>call</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>c</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>DY0x</span> <span class=o>=</span> <span class=nx>d</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=nx>b</span> <span class=o>=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>CBC</span> <span class=o>=</span> <span class=nx>q</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>q</span> <span class=o>=</span> <span class=p>(</span><span class=nx>p</span><span class=p>.</span><span class=nx>pad</span> <span class=o>=</span> <span class=p>{}).</span><span class=nx>Pkcs7</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>pad</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=mi>4</span> <span class=o>*</span> <span class=nx>b</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>c</span> <span class=o>=</span> <span class=nx>c</span> <span class=o>-</span> <span class=nx>a</span><span class=p>.</span><span class=nx>sigBytes</span> <span class=o>%</span> <span class=nx>c</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>d</span> <span class=o>=</span> <span class=nx>c</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>|</span> <span class=nx>c</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span> <span class=o>|</span> <span class=nx>c</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span> <span class=o>|</span> <span class=nx>c</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>l</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>n</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>n</span> <span class=o>&lt;</span> <span class=nx>c</span><span class=p>;</span> <span class=nx>n</span> <span class=o>+=</span> <span class=mi>4</span><span class=p>)</span> <span class=nx>l</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>d</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>c</span> <span class=o>=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>create</span><span class=p>(</span><span class=nx>l</span><span class=p>,</span> <span class=nx>c</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>a</span><span class=p>.</span><span class=nx>concat</span><span class=p>(</span><span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>unpad</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>a</span><span class=p>.</span><span class=nx>sigBytes</span> <span class=o>-=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>words</span><span class=p>[</span><span class=nx>a</span><span class=p>.</span><span class=nx>sigBytes</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>2</span><span class=p>]</span> <span class=o>&amp;</span> <span class=mi>255</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span><span class=p>.</span><span class=nx>BlockCipher</span> <span class=o>=</span> <span class=nx>v</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>cfg</span><span class=o>:</span> <span class=nx>v</span><span class=p>.</span><span class=nx>cfg</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>mode</span><span class=o>:</span> <span class=nx>b</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>padding</span><span class=o>:</span> <span class=nx>q</span>
</span></span><span class=line><span class=cl>            <span class=p>}),</span>
</span></span><span class=line><span class=cl>            <span class=nx>reset</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>v</span><span class=p>.</span><span class=nx>reset</span><span class=p>.</span><span class=nx>call</span><span class=p>(</span><span class=k>this</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>cfg</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>b</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>iv</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>mode</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>WW9N</span> <span class=o>==</span> <span class=k>this</span><span class=p>.</span><span class=nx>Hv1x</span><span class=p>)</span> <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>createEncryptor</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>createDecryptor</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>WX9O</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>eV2x</span> <span class=o>=</span> <span class=nx>c</span><span class=p>.</span><span class=nx>call</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=k>this</span><span class=p>,</span> <span class=nx>b</span> <span class=o>&amp;&amp;</span> <span class=nx>b</span><span class=p>.</span><span class=nx>words</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>sA7t</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>eV2x</span><span class=p>.</span><span class=nx>processBlock</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>oc5h</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>cfg</span><span class=p>.</span><span class=nx>padding</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>WW9N</span> <span class=o>==</span> <span class=k>this</span><span class=p>.</span><span class=nx>Hv1x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span><span class=p>.</span><span class=nx>pad</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>i0x</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>blockSize</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>mU5Z</span><span class=p>(</span><span class=o>!</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=k>else</span> <span class=nx>b</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>mU5Z</span><span class=p>(</span><span class=o>!</span><span class=mi>0</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span><span class=p>.</span><span class=nx>unpad</span><span class=p>(</span><span class=nx>b</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>blockSize</span><span class=o>:</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>n</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>CipherParams</span> <span class=o>=</span> <span class=nx>l</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>init</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>mixIn</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>toString</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>(</span><span class=nx>a</span> <span class=o>||</span> <span class=k>this</span><span class=p>.</span><span class=nx>formatter</span><span class=p>).</span><span class=nx>stringify</span><span class=p>(</span><span class=k>this</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}),</span>
</span></span><span class=line><span class=cl>            <span class=nx>b</span> <span class=o>=</span> <span class=p>(</span><span class=nx>p</span><span class=p>.</span><span class=nx>format</span> <span class=o>=</span> <span class=p>{}).</span><span class=nx>OpenSSL</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>stringify</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>ciphertext</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>salt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=p>(</span><span class=nx>a</span> <span class=o>?</span> <span class=nx>s</span><span class=p>.</span><span class=nx>create</span><span class=p>([</span><span class=mi>1398893684</span><span class=p>,</span> <span class=mi>1701076831</span><span class=p>]).</span><span class=nx>concat</span><span class=p>(</span><span class=nx>a</span><span class=p>).</span><span class=nx>concat</span><span class=p>(</span><span class=nx>b</span><span class=p>)</span> <span class=o>:</span> <span class=nx>b</span><span class=p>).</span><span class=nx>toString</span><span class=p>(</span><span class=nx>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>parse</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span> <span class=o>=</span> <span class=nx>r</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>words</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=p>(</span><span class=mi>1398893684</span> <span class=o>==</span> <span class=nx>b</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=mi>1701076831</span> <span class=o>==</span> <span class=nx>b</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>create</span><span class=p>(</span><span class=nx>b</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                        <span class=nx>b</span><span class=p>.</span><span class=nx>splice</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                        <span class=nx>a</span><span class=p>.</span><span class=nx>sigBytes</span> <span class=o>-=</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>n</span><span class=p>.</span><span class=nx>create</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                        <span class=nx>ciphertext</span><span class=o>:</span> <span class=nx>a</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>salt</span><span class=o>:</span> <span class=nx>c</span>
</span></span><span class=line><span class=cl>                    <span class=p>})</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>a</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>SerializableCipher</span> <span class=o>=</span> <span class=nx>l</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>cfg</span><span class=o>:</span> <span class=nx>l</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=nx>format</span><span class=o>:</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl>                <span class=p>}),</span>
</span></span><span class=line><span class=cl>                <span class=nx>encrypt</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>d</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>cfg</span><span class=p>.</span><span class=nx>extend</span><span class=p>(</span><span class=nx>d</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=kd>var</span> <span class=nx>l</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>createEncryptor</span><span class=p>(</span><span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>b</span> <span class=o>=</span> <span class=nx>l</span><span class=p>.</span><span class=nx>finalize</span><span class=p>(</span><span class=nx>b</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>l</span> <span class=o>=</span> <span class=nx>l</span><span class=p>.</span><span class=nx>cfg</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>n</span><span class=p>.</span><span class=nx>create</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                        <span class=nx>ciphertext</span><span class=o>:</span> <span class=nx>b</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>key</span><span class=o>:</span> <span class=nx>c</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>iv</span><span class=o>:</span> <span class=nx>l</span><span class=p>.</span><span class=nx>iv</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>algorithm</span><span class=o>:</span> <span class=nx>a</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>mode</span><span class=o>:</span> <span class=nx>l</span><span class=p>.</span><span class=nx>mode</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>padding</span><span class=o>:</span> <span class=nx>l</span><span class=p>.</span><span class=nx>padding</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>blockSize</span><span class=o>:</span> <span class=nx>a</span><span class=p>.</span><span class=nx>blockSize</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>formatter</span><span class=o>:</span> <span class=nx>d</span><span class=p>.</span><span class=nx>format</span>
</span></span><span class=line><span class=cl>                    <span class=p>})</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>decrypt</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>d</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>cfg</span><span class=p>.</span><span class=nx>extend</span><span class=p>(</span><span class=nx>d</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>b</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>Gc1x</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>d</span><span class=p>.</span><span class=nx>format</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>a</span><span class=p>.</span><span class=nx>createDecryptor</span><span class=p>(</span><span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>).</span><span class=nx>finalize</span><span class=p>(</span><span class=nx>b</span><span class=p>.</span><span class=nx>ciphertext</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>Gc1x</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=s2>&#34;string&#34;</span> <span class=o>==</span> <span class=k>typeof</span> <span class=nx>a</span> <span class=o>?</span> <span class=nx>b</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=k>this</span><span class=p>)</span> <span class=o>:</span> <span class=nx>a</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}),</span>
</span></span><span class=line><span class=cl>            <span class=nx>p</span> <span class=o>=</span> <span class=p>(</span><span class=nx>p</span><span class=p>.</span><span class=nx>kdf</span> <span class=o>=</span> <span class=p>{}).</span><span class=nx>OpenSSL</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>execute</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>d</span> <span class=o>||</span> <span class=p>(</span><span class=nx>d</span> <span class=o>=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>random</span><span class=p>(</span><span class=mi>8</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span> <span class=o>=</span> <span class=nx>w</span><span class=p>.</span><span class=nx>create</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                        <span class=nx>keySize</span><span class=o>:</span> <span class=nx>b</span> <span class=o>+</span> <span class=nx>c</span>
</span></span><span class=line><span class=cl>                    <span class=p>}).</span><span class=nx>compute</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>d</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>c</span> <span class=o>=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>create</span><span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>words</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=nx>b</span><span class=p>),</span> <span class=mi>4</span> <span class=o>*</span> <span class=nx>c</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span><span class=p>.</span><span class=nx>sigBytes</span> <span class=o>=</span> <span class=mi>4</span> <span class=o>*</span> <span class=nx>b</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>n</span><span class=p>.</span><span class=nx>create</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                        <span class=nx>key</span><span class=o>:</span> <span class=nx>a</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>iv</span><span class=o>:</span> <span class=nx>c</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>salt</span><span class=o>:</span> <span class=nx>d</span>
</span></span><span class=line><span class=cl>                    <span class=p>})</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>c</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>PasswordBasedCipher</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>cfg</span><span class=o>:</span> <span class=nx>a</span><span class=p>.</span><span class=nx>cfg</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=nx>kdf</span><span class=o>:</span> <span class=nx>p</span>
</span></span><span class=line><span class=cl>                <span class=p>}),</span>
</span></span><span class=line><span class=cl>                <span class=nx>encrypt</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>l</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>l</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>cfg</span><span class=p>.</span><span class=nx>extend</span><span class=p>(</span><span class=nx>l</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>d</span> <span class=o>=</span> <span class=nx>l</span><span class=p>.</span><span class=nx>kdf</span><span class=p>.</span><span class=nx>execute</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>b</span><span class=p>.</span><span class=nx>keySize</span><span class=p>,</span> <span class=nx>b</span><span class=p>.</span><span class=nx>ivSize</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>l</span><span class=p>.</span><span class=nx>iv</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>iv</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>b</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>encrypt</span><span class=p>.</span><span class=nx>call</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>.</span><span class=nx>key</span><span class=p>,</span> <span class=nx>l</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>b</span><span class=p>.</span><span class=nx>mixIn</span><span class=p>(</span><span class=nx>d</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>decrypt</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>l</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>l</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>cfg</span><span class=p>.</span><span class=nx>extend</span><span class=p>(</span><span class=nx>l</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>c</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>Gc1x</span><span class=p>(</span><span class=nx>c</span><span class=p>,</span> <span class=nx>l</span><span class=p>.</span><span class=nx>format</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>d</span> <span class=o>=</span> <span class=nx>l</span><span class=p>.</span><span class=nx>kdf</span><span class=p>.</span><span class=nx>execute</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>b</span><span class=p>.</span><span class=nx>keySize</span><span class=p>,</span> <span class=nx>b</span><span class=p>.</span><span class=nx>ivSize</span><span class=p>,</span> <span class=nx>c</span><span class=p>.</span><span class=nx>salt</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>l</span><span class=p>.</span><span class=nx>iv</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>iv</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>a</span><span class=p>.</span><span class=nx>decrypt</span><span class=p>.</span><span class=nx>call</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>.</span><span class=nx>key</span><span class=p>,</span> <span class=nx>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>}();</span> <span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>u</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>p</span> <span class=o>=</span> <span class=nx>u</span><span class=p>.</span><span class=nx>lib</span><span class=p>.</span><span class=nx>BlockCipher</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>d</span> <span class=o>=</span> <span class=nx>u</span><span class=p>.</span><span class=nx>algo</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>l</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>s</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>t</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>r</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>w</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>v</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>b</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>x</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>q</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>n</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>a</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>c</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>256</span> <span class=o>&gt;</span> <span class=nx>c</span><span class=p>;</span> <span class=nx>c</span><span class=o>++</span><span class=p>)</span> <span class=nx>a</span><span class=p>[</span><span class=nx>c</span><span class=p>]</span> <span class=o>=</span> <span class=mi>128</span> <span class=o>&gt;</span> <span class=nx>c</span> <span class=o>?</span> <span class=nx>c</span> <span class=o>&lt;&lt;</span> <span class=mi>1</span> <span class=o>:</span> <span class=nx>c</span> <span class=o>&lt;&lt;</span> <span class=mi>1</span> <span class=o>^</span> <span class=mi>283</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>e</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>c</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>256</span> <span class=o>&gt;</span> <span class=nx>c</span><span class=p>;</span> <span class=nx>c</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kd>var</span> <span class=nx>k</span> <span class=o>=</span> <span class=nx>j</span> <span class=o>^</span> <span class=nx>j</span> <span class=o>&lt;&lt;</span> <span class=mi>1</span> <span class=o>^</span> <span class=nx>j</span> <span class=o>&lt;&lt;</span> <span class=mi>2</span> <span class=o>^</span> <span class=nx>j</span> <span class=o>&lt;&lt;</span> <span class=mi>3</span> <span class=o>^</span> <span class=nx>j</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>k</span> <span class=o>=</span> <span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span> <span class=o>^</span> <span class=nx>k</span> <span class=o>&amp;</span> <span class=mi>255</span> <span class=o>^</span> <span class=mi>99</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>l</span><span class=p>[</span><span class=nx>e</span><span class=p>]</span> <span class=o>=</span> <span class=nx>k</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>s</span><span class=p>[</span><span class=nx>k</span><span class=p>]</span> <span class=o>=</span> <span class=nx>e</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kd>var</span> <span class=nx>z</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>e</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=nx>F</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>z</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=nx>G</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>F</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=nx>y</span> <span class=o>=</span> <span class=mi>257</span> <span class=o>*</span> <span class=nx>a</span><span class=p>[</span><span class=nx>k</span><span class=p>]</span> <span class=o>^</span> <span class=mi>16843008</span> <span class=o>*</span> <span class=nx>k</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>t</span><span class=p>[</span><span class=nx>e</span><span class=p>]</span> <span class=o>=</span> <span class=nx>y</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>|</span> <span class=nx>y</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>r</span><span class=p>[</span><span class=nx>e</span><span class=p>]</span> <span class=o>=</span> <span class=nx>y</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span> <span class=o>|</span> <span class=nx>y</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>16</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>w</span><span class=p>[</span><span class=nx>e</span><span class=p>]</span> <span class=o>=</span> <span class=nx>y</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span> <span class=o>|</span> <span class=nx>y</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>v</span><span class=p>[</span><span class=nx>e</span><span class=p>]</span> <span class=o>=</span> <span class=nx>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>y</span> <span class=o>=</span> <span class=mi>16843009</span> <span class=o>*</span> <span class=nx>G</span> <span class=o>^</span> <span class=mi>65537</span> <span class=o>*</span> <span class=nx>F</span> <span class=o>^</span> <span class=mi>257</span> <span class=o>*</span> <span class=nx>z</span> <span class=o>^</span> <span class=mi>16843008</span> <span class=o>*</span> <span class=nx>e</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>b</span><span class=p>[</span><span class=nx>k</span><span class=p>]</span> <span class=o>=</span> <span class=nx>y</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>|</span> <span class=nx>y</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>x</span><span class=p>[</span><span class=nx>k</span><span class=p>]</span> <span class=o>=</span> <span class=nx>y</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span> <span class=o>|</span> <span class=nx>y</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>16</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>q</span><span class=p>[</span><span class=nx>k</span><span class=p>]</span> <span class=o>=</span> <span class=nx>y</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span> <span class=o>|</span> <span class=nx>y</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>n</span><span class=p>[</span><span class=nx>k</span><span class=p>]</span> <span class=o>=</span> <span class=nx>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>e</span> <span class=o>?</span> <span class=p>(</span><span class=nx>e</span> <span class=o>=</span> <span class=nx>z</span> <span class=o>^</span> <span class=nx>a</span><span class=p>[</span><span class=nx>a</span><span class=p>[</span><span class=nx>a</span><span class=p>[</span><span class=nx>G</span> <span class=o>^</span> <span class=nx>z</span><span class=p>]]],</span> <span class=nx>j</span> <span class=o>^=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>a</span><span class=p>[</span><span class=nx>j</span><span class=p>]])</span> <span class=o>:</span> <span class=nx>e</span> <span class=o>=</span> <span class=nx>j</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>H</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>64</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>27</span><span class=p>,</span> <span class=mi>54</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nx>d</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>AES</span> <span class=o>=</span> <span class=nx>p</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>ma4e</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>J0x</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>c</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>words</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>d</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>sigBytes</span> <span class=o>/</span> <span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>a</span> <span class=o>=</span> <span class=mi>4</span> <span class=o>*</span> <span class=p>((</span><span class=k>this</span><span class=p>.</span><span class=nx>ZE0x</span> <span class=o>=</span> <span class=nx>d</span> <span class=o>+</span> <span class=mi>6</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span> <span class=nx>e</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>bsc6W</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>j</span> <span class=o>&lt;</span> <span class=nx>a</span><span class=p>;</span> <span class=nx>j</span><span class=o>++</span><span class=p>)</span> <span class=k>if</span> <span class=p>(</span><span class=nx>j</span> <span class=o>&lt;</span> <span class=nx>d</span><span class=p>)</span> <span class=nx>e</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=o>=</span> <span class=nx>c</span><span class=p>[</span><span class=nx>j</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                        <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                            <span class=kd>var</span> <span class=nx>k</span> <span class=o>=</span> <span class=nx>e</span><span class=p>[</span><span class=nx>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                            <span class=nx>j</span> <span class=o>%</span> <span class=nx>d</span> <span class=o>?</span> <span class=mi>6</span> <span class=o>&lt;</span> <span class=nx>d</span> <span class=o>&amp;&amp;</span> <span class=mi>4</span> <span class=o>==</span> <span class=nx>j</span> <span class=o>%</span> <span class=nx>d</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nx>k</span> <span class=o>=</span> <span class=nx>l</span><span class=p>[</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>|</span> <span class=nx>l</span><span class=p>[</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>16</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span> <span class=o>|</span> <span class=nx>l</span><span class=p>[</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span> <span class=o>|</span> <span class=nx>l</span><span class=p>[</span><span class=nx>k</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>])</span> <span class=o>:</span> <span class=p>(</span><span class=nx>k</span> <span class=o>=</span> <span class=nx>k</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span> <span class=o>|</span> <span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>,</span> <span class=nx>k</span> <span class=o>=</span> <span class=nx>l</span><span class=p>[</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>|</span> <span class=nx>l</span><span class=p>[</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>16</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span> <span class=o>|</span> <span class=nx>l</span><span class=p>[</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span> <span class=o>|</span> <span class=nx>l</span><span class=p>[</span><span class=nx>k</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>],</span> <span class=nx>k</span> <span class=o>^=</span> <span class=nx>H</span><span class=p>[</span><span class=nx>j</span> <span class=o>/</span> <span class=nx>d</span> <span class=o>|</span> <span class=mi>0</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                            <span class=nx>e</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=o>=</span> <span class=nx>e</span><span class=p>[</span><span class=nx>j</span> <span class=o>-</span> <span class=nx>d</span><span class=p>]</span> <span class=o>^</span> <span class=nx>k</span>
</span></span><span class=line><span class=cl>                        <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=nx>c</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>bsg6a</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>                    <span class=k>for</span> <span class=p>(</span><span class=nx>d</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>d</span> <span class=o>&lt;</span> <span class=nx>a</span><span class=p>;</span> <span class=nx>d</span><span class=o>++</span><span class=p>)</span> <span class=nx>j</span> <span class=o>=</span> <span class=nx>a</span> <span class=o>-</span> <span class=nx>d</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>k</span> <span class=o>=</span> <span class=nx>d</span> <span class=o>%</span> <span class=mi>4</span> <span class=o>?</span> <span class=nx>e</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=o>:</span> <span class=nx>e</span><span class=p>[</span><span class=nx>j</span> <span class=o>-</span> <span class=mi>4</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                        <span class=nx>c</span><span class=p>[</span><span class=nx>d</span><span class=p>]</span> <span class=o>=</span> <span class=mi>4</span> <span class=o>&gt;</span> <span class=nx>d</span> <span class=o>||</span> <span class=mi>4</span> <span class=o>&gt;=</span> <span class=nx>j</span> <span class=o>?</span> <span class=nx>k</span> <span class=o>:</span> <span class=nx>b</span><span class=p>[</span><span class=nx>l</span><span class=p>[</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>]]</span> <span class=o>^</span> <span class=nx>x</span><span class=p>[</span><span class=nx>l</span><span class=p>[</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>16</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]]</span> <span class=o>^</span> <span class=nx>q</span><span class=p>[</span><span class=nx>l</span><span class=p>[</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]]</span> <span class=o>^</span> <span class=nx>n</span><span class=p>[</span><span class=nx>l</span><span class=p>[</span><span class=nx>k</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>encryptBlock</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>Ec0x</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>bsc6W</span><span class=p>,</span> <span class=nx>t</span><span class=p>,</span> <span class=nx>r</span><span class=p>,</span> <span class=nx>w</span><span class=p>,</span> <span class=nx>v</span><span class=p>,</span> <span class=nx>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>decryptBlock</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kd>var</span> <span class=nx>d</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>c</span> <span class=o>+</span> <span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span><span class=p>[</span><span class=nx>c</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>c</span> <span class=o>+</span> <span class=mi>3</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span><span class=p>[</span><span class=nx>c</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=nx>d</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>Ec0x</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>bsg6a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>x</span><span class=p>,</span> <span class=nx>q</span><span class=p>,</span> <span class=nx>n</span><span class=p>,</span> <span class=nx>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>d</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>c</span> <span class=o>+</span> <span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span><span class=p>[</span><span class=nx>c</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>c</span> <span class=o>+</span> <span class=mi>3</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span><span class=p>[</span><span class=nx>c</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=nx>d</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>Ec0x</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>j</span><span class=p>,</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>f</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>m</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>ZE0x</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>g</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>b</span><span class=p>]</span> <span class=o>^</span> <span class=nx>c</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=nx>h</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>b</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>^</span> <span class=nx>c</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=nx>k</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>b</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span> <span class=o>^</span> <span class=nx>c</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=nx>n</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>b</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>^</span> <span class=nx>c</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span> <span class=nx>p</span> <span class=o>=</span> <span class=mi>4</span><span class=p>,</span> <span class=nx>r</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>r</span> <span class=o>&lt;</span> <span class=nx>m</span><span class=p>;</span> <span class=nx>r</span><span class=o>++</span><span class=p>)</span> <span class=kd>var</span> <span class=nx>q</span> <span class=o>=</span> <span class=nx>d</span><span class=p>[</span><span class=nx>g</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>]</span> <span class=o>^</span> <span class=nx>e</span><span class=p>[</span><span class=nx>h</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>16</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>^</span> <span class=nx>j</span><span class=p>[</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>^</span> <span class=nx>l</span><span class=p>[</span><span class=nx>n</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>^</span> <span class=nx>c</span><span class=p>[</span><span class=nx>p</span><span class=o>++</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                            <span class=nx>s</span> <span class=o>=</span> <span class=nx>d</span><span class=p>[</span><span class=nx>h</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>]</span> <span class=o>^</span> <span class=nx>e</span><span class=p>[</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>16</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>^</span> <span class=nx>j</span><span class=p>[</span><span class=nx>n</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>^</span> <span class=nx>l</span><span class=p>[</span><span class=nx>g</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>^</span> <span class=nx>c</span><span class=p>[</span><span class=nx>p</span><span class=o>++</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                            <span class=nx>t</span> <span class=o>=</span> <span class=nx>d</span><span class=p>[</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>]</span> <span class=o>^</span> <span class=nx>e</span><span class=p>[</span><span class=nx>n</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>16</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>^</span> <span class=nx>j</span><span class=p>[</span><span class=nx>g</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>^</span> <span class=nx>l</span><span class=p>[</span><span class=nx>h</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>^</span> <span class=nx>c</span><span class=p>[</span><span class=nx>p</span><span class=o>++</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                            <span class=nx>n</span> <span class=o>=</span> <span class=nx>d</span><span class=p>[</span><span class=nx>n</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>]</span> <span class=o>^</span> <span class=nx>e</span><span class=p>[</span><span class=nx>g</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>16</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>^</span> <span class=nx>j</span><span class=p>[</span><span class=nx>h</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>^</span> <span class=nx>l</span><span class=p>[</span><span class=nx>k</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>^</span> <span class=nx>c</span><span class=p>[</span><span class=nx>p</span><span class=o>++</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                            <span class=nx>g</span> <span class=o>=</span> <span class=nx>q</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                            <span class=nx>h</span> <span class=o>=</span> <span class=nx>s</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                            <span class=nx>k</span> <span class=o>=</span> <span class=nx>t</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>q</span> <span class=o>=</span> <span class=p>(</span><span class=nx>f</span><span class=p>[</span><span class=nx>g</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>|</span> <span class=nx>f</span><span class=p>[</span><span class=nx>h</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>16</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span> <span class=o>|</span> <span class=nx>f</span><span class=p>[</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span> <span class=o>|</span> <span class=nx>f</span><span class=p>[</span><span class=nx>n</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>])</span> <span class=o>^</span> <span class=nx>c</span><span class=p>[</span><span class=nx>p</span><span class=o>++</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=nx>s</span> <span class=o>=</span> <span class=p>(</span><span class=nx>f</span><span class=p>[</span><span class=nx>h</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>|</span> <span class=nx>f</span><span class=p>[</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>16</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span> <span class=o>|</span> <span class=nx>f</span><span class=p>[</span><span class=nx>n</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span> <span class=o>|</span> <span class=nx>f</span><span class=p>[</span><span class=nx>g</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>])</span> <span class=o>^</span> <span class=nx>c</span><span class=p>[</span><span class=nx>p</span><span class=o>++</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=nx>t</span> <span class=o>=</span> <span class=p>(</span><span class=nx>f</span><span class=p>[</span><span class=nx>k</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>|</span> <span class=nx>f</span><span class=p>[</span><span class=nx>n</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>16</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span> <span class=o>|</span> <span class=nx>f</span><span class=p>[</span><span class=nx>g</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span> <span class=o>|</span> <span class=nx>f</span><span class=p>[</span><span class=nx>h</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>])</span> <span class=o>^</span> <span class=nx>c</span><span class=p>[</span><span class=nx>p</span><span class=o>++</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=nx>n</span> <span class=o>=</span> <span class=p>(</span><span class=nx>f</span><span class=p>[</span><span class=nx>n</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>24</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>24</span> <span class=o>|</span> <span class=nx>f</span><span class=p>[</span><span class=nx>g</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>16</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span> <span class=o>|</span> <span class=nx>f</span><span class=p>[</span><span class=nx>h</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>8</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span> <span class=o>|</span> <span class=nx>f</span><span class=p>[</span><span class=nx>k</span> <span class=o>&amp;</span> <span class=mi>255</span><span class=p>])</span> <span class=o>^</span> <span class=nx>c</span><span class=p>[</span><span class=nx>p</span><span class=o>++</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span><span class=p>[</span><span class=nx>b</span><span class=p>]</span> <span class=o>=</span> <span class=nx>q</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span><span class=p>[</span><span class=nx>b</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=nx>s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span><span class=p>[</span><span class=nx>b</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=nx>t</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>a</span><span class=p>[</span><span class=nx>b</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=nx>n</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>keySize</span><span class=o>:</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=nx>u</span><span class=p>.</span><span class=nx>AES</span> <span class=o>=</span> <span class=nx>p</span><span class=p>.</span><span class=nx>mF4J</span><span class=p>(</span><span class=nx>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})();</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>RSAKeyPair</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>e</span> <span class=o>=</span> <span class=nx>biFromHex</span><span class=p>(</span><span class=nx>a</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>d</span> <span class=o>=</span> <span class=nx>biFromHex</span><span class=p>(</span><span class=nx>b</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>m</span> <span class=o>=</span> <span class=nx>biFromHex</span><span class=p>(</span><span class=nx>c</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>chunkSize</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=nx>biHighIndex</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>m</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>radix</span> <span class=o>=</span> <span class=mi>16</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>barrett</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BarrettMu</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>twoDigit</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=mi>10</span> <span class=o>&gt;</span> <span class=nx>a</span> <span class=o>?</span> <span class=s2>&#34;0&#34;</span> <span class=o>:</span> <span class=s2>&#34;&#34;</span><span class=p>)</span> <span class=o>+</span> <span class=nb>String</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>encryptedString</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>j</span><span class=p>,</span> <span class=nx>k</span><span class=p>,</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>c</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Array</span><span class=p>,</span> <span class=nx>d</span> <span class=o>=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>length</span><span class=p>,</span> <span class=nx>e</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>d</span> <span class=o>&gt;</span> <span class=nx>e</span><span class=p>;)</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span><span class=p>[</span><span class=nx>e</span><span class=p>]</span> <span class=o>=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>charCodeAt</span><span class=p>(</span><span class=nx>e</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>e</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(;</span> <span class=mi>0</span> <span class=o>!=</span> <span class=nx>c</span><span class=p>.</span><span class=nx>length</span> <span class=o>%</span> <span class=nx>a</span><span class=p>.</span><span class=nx>chunkSize</span><span class=p>;)</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span><span class=p>[</span><span class=nx>e</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>f</span> <span class=o>=</span> <span class=nx>c</span><span class=p>.</span><span class=nx>length</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>g</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>e</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>f</span> <span class=o>&gt;</span> <span class=nx>e</span><span class=p>;</span> <span class=nx>e</span> <span class=o>+=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>chunkSize</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=nx>j</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>h</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>i</span> <span class=o>=</span> <span class=nx>e</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>e</span> <span class=o>+</span> <span class=nx>a</span><span class=p>.</span><span class=nx>chunkSize</span><span class=p>;</span> <span class=o>++</span><span class=nx>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>j</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>h</span><span class=p>]</span> <span class=o>=</span> <span class=nx>c</span><span class=p>[</span><span class=nx>i</span><span class=o>++</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=nx>j</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>h</span><span class=p>]</span> <span class=o>+=</span> <span class=nx>c</span><span class=p>[</span><span class=nx>i</span><span class=o>++</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>k</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>barrett</span><span class=p>.</span><span class=nx>powMod</span><span class=p>(</span><span class=nx>j</span><span class=p>,</span> <span class=nx>a</span><span class=p>.</span><span class=nx>e</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>l</span> <span class=o>=</span> <span class=mi>16</span> <span class=o>==</span> <span class=nx>a</span><span class=p>.</span><span class=nx>radix</span> <span class=o>?</span> <span class=nx>biToHex</span><span class=p>(</span><span class=nx>k</span><span class=p>)</span> <span class=o>:</span> <span class=nx>biToString</span><span class=p>(</span><span class=nx>k</span><span class=p>,</span> <span class=nx>a</span><span class=p>.</span><span class=nx>radix</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>g</span> <span class=o>+=</span> <span class=nx>l</span> <span class=o>+</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>g</span><span class=p>.</span><span class=nx>substring</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>g</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>decryptedString</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s2>&#34; &#34;</span><span class=p>),</span> <span class=nx>d</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>e</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>e</span> <span class=o>&lt;</span> <span class=nx>c</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=o>++</span><span class=nx>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=nx>h</span> <span class=o>=</span> <span class=mi>16</span> <span class=o>==</span> <span class=nx>a</span><span class=p>.</span><span class=nx>radix</span> <span class=o>?</span> <span class=nx>biFromHex</span><span class=p>(</span><span class=nx>c</span><span class=p>[</span><span class=nx>e</span><span class=p>])</span> <span class=o>:</span> <span class=nx>biFromString</span><span class=p>(</span><span class=nx>c</span><span class=p>[</span><span class=nx>e</span><span class=p>],</span> <span class=nx>a</span><span class=p>.</span><span class=nx>radix</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>g</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>barrett</span><span class=p>.</span><span class=nx>powMod</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>a</span><span class=p>.</span><span class=nx>d</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>f</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>f</span> <span class=o>&lt;=</span> <span class=nx>biHighIndex</span><span class=p>(</span><span class=nx>g</span><span class=p>);</span> <span class=o>++</span><span class=nx>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>d</span> <span class=o>+=</span> <span class=nb>String</span><span class=p>.</span><span class=nx>fromCharCode</span><span class=p>(</span><span class=mi>255</span> <span class=o>&amp;</span> <span class=nx>g</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>f</span><span class=p>],</span> <span class=nx>g</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span> <span class=o>==</span> <span class=nx>d</span><span class=p>.</span><span class=nx>charCodeAt</span><span class=p>(</span><span class=nx>d</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nx>d</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>substring</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>d</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>setMaxDigits</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>maxDigits</span> <span class=o>=</span> <span class=nx>a</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>ZERO_ARRAY</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Array</span><span class=p>(</span><span class=nx>maxDigits</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>b</span> <span class=o>&lt;</span> <span class=nx>ZERO_ARRAY</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=nx>b</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>ZERO_ARRAY</span><span class=p>[</span><span class=nx>b</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>bigZero</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>bigOne</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>bigOne</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>BigInt</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>digits</span> <span class=o>=</span> <span class=s2>&#34;boolean&#34;</span> <span class=o>==</span> <span class=k>typeof</span> <span class=nx>a</span> <span class=o>&amp;&amp;</span> <span class=mi>1</span> <span class=o>==</span> <span class=nx>a</span> <span class=o>?</span> <span class=kc>null</span> <span class=o>:</span> <span class=nx>ZERO_ARRAY</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=o>!</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biFromDecimal</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>b</span> <span class=o>=</span> <span class=s2>&#34;-&#34;</span> <span class=o>==</span> <span class=nx>a</span><span class=p>.</span><span class=nx>charAt</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>b</span> <span class=o>?</span> <span class=mi>1</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>c</span> <span class=o>&lt;</span> <span class=nx>a</span><span class=p>.</span><span class=nx>length</span> <span class=o>&amp;&amp;</span> <span class=s2>&#34;0&#34;</span> <span class=o>==</span> <span class=nx>a</span><span class=p>.</span><span class=nx>charAt</span><span class=p>(</span><span class=nx>c</span><span class=p>);)</span>
</span></span><span class=line><span class=cl>        <span class=o>++</span><span class=nx>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>c</span> <span class=o>==</span> <span class=nx>a</span><span class=p>.</span><span class=nx>length</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=nx>e</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=nx>c</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>f</span> <span class=o>=</span> <span class=nx>e</span> <span class=o>%</span> <span class=nx>dpl10</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=mi>0</span> <span class=o>==</span> <span class=nx>f</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nx>f</span> <span class=o>=</span> <span class=nx>dpl10</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>d</span> <span class=o>=</span> <span class=nx>biFromNumber</span><span class=p>(</span><span class=nb>Number</span><span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>substr</span><span class=p>(</span><span class=nx>c</span><span class=p>,</span> <span class=nx>f</span><span class=p>))),</span>
</span></span><span class=line><span class=cl>            <span class=nx>c</span> <span class=o>+=</span> <span class=nx>f</span><span class=p>;</span> <span class=nx>c</span> <span class=o>&lt;</span> <span class=nx>a</span><span class=p>.</span><span class=nx>length</span><span class=p>;)</span>
</span></span><span class=line><span class=cl>            <span class=nx>d</span> <span class=o>=</span> <span class=nx>biAdd</span><span class=p>(</span><span class=nx>biMultiply</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>lr10</span><span class=p>),</span> <span class=nx>biFromNumber</span><span class=p>(</span><span class=nb>Number</span><span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>substr</span><span class=p>(</span><span class=nx>c</span><span class=p>,</span> <span class=nx>dpl10</span><span class=p>)))),</span>
</span></span><span class=line><span class=cl>                <span class=nx>c</span> <span class=o>+=</span> <span class=nx>dpl10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>d</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biCopy</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>(</span><span class=o>!</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>b</span><span class=p>.</span><span class=nx>digits</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>b</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biFromNumber</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>b</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=mi>0</span> <span class=o>&gt;</span> <span class=nx>a</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>a</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>abs</span><span class=p>(</span><span class=nx>a</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>a</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>;)</span>
</span></span><span class=line><span class=cl>        <span class=nx>b</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>c</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=nx>a</span> <span class=o>&amp;</span> <span class=nx>maxDigitVal</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>a</span> <span class=o>&gt;&gt;=</span> <span class=nx>biRadixBits</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>reverseStr</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>b</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>c</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>c</span> <span class=o>&gt;</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span> <span class=o>--</span><span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>b</span> <span class=o>+=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>charAt</span><span class=p>(</span><span class=nx>c</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biToString</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>c</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=nx>b</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span> <span class=o>=</span> <span class=nx>biDivideModulo</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>c</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>e</span> <span class=o>=</span> <span class=nx>hexatrigesimalToChar</span><span class=p>[</span><span class=nx>d</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=nx>digits</span><span class=p>[</span><span class=mi>0</span><span class=p>]];</span> <span class=mi>1</span> <span class=o>==</span> <span class=nx>biCompare</span><span class=p>(</span><span class=nx>d</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=nx>bigZero</span><span class=p>);)</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span> <span class=o>=</span> <span class=nx>biDivideModulo</span><span class=p>(</span><span class=nx>d</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=nx>c</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>digit</span> <span class=o>=</span> <span class=nx>d</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=nx>digits</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nx>e</span> <span class=o>+=</span> <span class=nx>hexatrigesimalToChar</span><span class=p>[</span><span class=nx>d</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=nx>digits</span><span class=p>[</span><span class=mi>0</span><span class=p>]];</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>?</span> <span class=s2>&#34;-&#34;</span> <span class=o>:</span> <span class=s2>&#34;&#34;</span><span class=p>)</span> <span class=o>+</span> <span class=nx>reverseStr</span><span class=p>(</span><span class=nx>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biToDecimal</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>b</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>b</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>10</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span> <span class=o>=</span> <span class=nx>biDivideModulo</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span> <span class=o>=</span> <span class=nb>String</span><span class=p>(</span><span class=nx>c</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=nx>digits</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span> <span class=mi>1</span> <span class=o>==</span> <span class=nx>biCompare</span><span class=p>(</span><span class=nx>c</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=nx>bigZero</span><span class=p>);)</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span> <span class=o>=</span> <span class=nx>biDivideModulo</span><span class=p>(</span><span class=nx>c</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=nx>b</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>d</span> <span class=o>+=</span> <span class=nb>String</span><span class=p>(</span><span class=nx>c</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=nx>digits</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>?</span> <span class=s2>&#34;-&#34;</span> <span class=o>:</span> <span class=s2>&#34;&#34;</span><span class=p>)</span> <span class=o>+</span> <span class=nx>reverseStr</span><span class=p>(</span><span class=nx>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>digitToHex</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=mi>15</span>
</span></span><span class=line><span class=cl>        <span class=p>,</span> <span class=nx>c</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>4</span> <span class=o>&gt;</span> <span class=nx>i</span><span class=p>;</span> <span class=o>++</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span> <span class=o>+=</span> <span class=nx>hexToChar</span><span class=p>[</span><span class=nx>a</span> <span class=o>&amp;</span> <span class=nx>b</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nx>a</span> <span class=o>&gt;&gt;&gt;=</span> <span class=mi>4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>reverseStr</span><span class=p>(</span><span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biToHex</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>b</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>biHighIndex</span><span class=p>(</span><span class=nx>a</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span> <span class=o>=</span> <span class=nx>biHighIndex</span><span class=p>(</span><span class=nx>a</span><span class=p>);</span> <span class=nx>d</span> <span class=o>&gt;</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span> <span class=o>--</span><span class=nx>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>b</span> <span class=o>+=</span> <span class=nx>digitToHex</span><span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>d</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>charToHex</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>b</span> <span class=o>=</span> <span class=mi>48</span><span class=p>,</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>b</span> <span class=o>+</span> <span class=mi>9</span><span class=p>,</span> <span class=nx>d</span> <span class=o>=</span> <span class=mi>97</span><span class=p>,</span> <span class=nx>e</span> <span class=o>=</span> <span class=nx>d</span> <span class=o>+</span> <span class=mi>25</span><span class=p>,</span> <span class=nx>f</span> <span class=o>=</span> <span class=mi>65</span><span class=p>,</span> <span class=nx>g</span> <span class=o>=</span> <span class=mi>90</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>h</span> <span class=o>=</span> <span class=nx>a</span> <span class=o>&gt;=</span> <span class=nx>b</span> <span class=o>&amp;&amp;</span> <span class=nx>c</span> <span class=o>&gt;=</span> <span class=nx>a</span> <span class=o>?</span> <span class=nx>a</span> <span class=o>-</span> <span class=nx>b</span> <span class=o>:</span> <span class=nx>a</span> <span class=o>&gt;=</span> <span class=nx>f</span> <span class=o>&amp;&amp;</span> <span class=nx>g</span> <span class=o>&gt;=</span> <span class=nx>a</span> <span class=o>?</span> <span class=mi>10</span> <span class=o>+</span> <span class=nx>a</span> <span class=o>-</span> <span class=nx>f</span> <span class=o>:</span> <span class=nx>a</span> <span class=o>&gt;=</span> <span class=nx>d</span> <span class=o>&amp;&amp;</span> <span class=nx>e</span> <span class=o>&gt;=</span> <span class=nx>a</span> <span class=o>?</span> <span class=mi>10</span> <span class=o>+</span> <span class=nx>a</span> <span class=o>-</span> <span class=nx>d</span> <span class=o>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>hexToDigit</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>b</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>c</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>min</span><span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>length</span><span class=p>,</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>d</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>c</span> <span class=o>&gt;</span> <span class=nx>d</span><span class=p>;</span> <span class=o>++</span><span class=nx>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>b</span> <span class=o>&lt;&lt;=</span> <span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>b</span> <span class=o>|=</span> <span class=nx>charToHex</span><span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>charCodeAt</span><span class=p>(</span><span class=nx>d</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>//010001
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>biFromHex</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// a = &#34;11234235325435354432423423423423434232352352354234&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>b</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>,</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>d</span> <span class=o>=</span> <span class=nx>c</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>e</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>d</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>d</span> <span class=o>-=</span> <span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=o>++</span><span class=nx>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>b</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>e</span><span class=p>]</span> <span class=o>=</span> <span class=nx>hexToDigit</span><span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>substr</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>max</span><span class=p>(</span><span class=nx>d</span> <span class=o>-</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>min</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=mi>4</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biFromString</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>j</span><span class=p>,</span> <span class=nx>c</span> <span class=o>=</span> <span class=s2>&#34;-&#34;</span> <span class=o>==</span> <span class=nx>a</span><span class=p>.</span><span class=nx>charAt</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span> <span class=nx>d</span> <span class=o>=</span> <span class=nx>c</span> <span class=o>?</span> <span class=mi>1</span> <span class=o>:</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>e</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>,</span> <span class=nx>f</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>f</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>g</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>g</span> <span class=o>&gt;=</span> <span class=nx>d</span><span class=p>;</span> <span class=nx>g</span><span class=o>--</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>h</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>charCodeAt</span><span class=p>(</span><span class=nx>g</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>i</span> <span class=o>=</span> <span class=nx>charToHex</span><span class=p>(</span><span class=nx>h</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>j</span> <span class=o>=</span> <span class=nx>biMultiplyDigit</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>i</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>e</span> <span class=o>=</span> <span class=nx>biAdd</span><span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>j</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>f</span> <span class=o>=</span> <span class=nx>biMultiplyDigit</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>b</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>e</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=nx>c</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>e</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biDump</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>?</span> <span class=s2>&#34;-&#34;</span> <span class=o>:</span> <span class=s2>&#34;&#34;</span><span class=p>)</span> <span class=o>+</span> <span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=s2>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biAdd</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>f</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>!=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=o>!</span><span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>c</span> <span class=o>=</span> <span class=nx>biSubtract</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=o>!</span><span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=nx>c</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>d</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>f</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>f</span> <span class=o>&lt;</span> <span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=o>++</span><span class=nx>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>e</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span> <span class=o>+</span> <span class=nx>b</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span> <span class=o>+</span> <span class=nx>d</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span> <span class=o>=</span> <span class=mi>65535</span> <span class=o>&amp;</span> <span class=nx>e</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>d</span> <span class=o>=</span> <span class=nb>Number</span><span class=p>(</span><span class=nx>e</span> <span class=o>&gt;=</span> <span class=nx>biRadix</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>c</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biSubtract</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>f</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>!=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=o>!</span><span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>c</span> <span class=o>=</span> <span class=nx>biAdd</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=o>!</span><span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=nx>c</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>e</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>f</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>f</span> <span class=o>&lt;</span> <span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=o>++</span><span class=nx>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>d</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span> <span class=o>-</span> <span class=nx>b</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span> <span class=o>+</span> <span class=nx>e</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span> <span class=o>=</span> <span class=mi>65535</span> <span class=o>&amp;</span> <span class=nx>d</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span> <span class=o>+=</span> <span class=nx>biRadix</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=nx>e</span> <span class=o>=</span> <span class=mi>0</span> <span class=o>-</span> <span class=nb>Number</span><span class=p>(</span><span class=mi>0</span> <span class=o>&gt;</span> <span class=nx>d</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>-</span><span class=mi>1</span> <span class=o>==</span> <span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=p>(</span><span class=nx>e</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>f</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>f</span> <span class=o>&lt;</span> <span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=o>++</span><span class=nx>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nx>d</span> <span class=o>=</span> <span class=mi>0</span> <span class=o>-</span> <span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span> <span class=o>+</span> <span class=nx>e</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span> <span class=o>=</span> <span class=mi>65535</span> <span class=o>&amp;</span> <span class=nx>d</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span> <span class=o>+=</span> <span class=nx>biRadix</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=nx>e</span> <span class=o>=</span> <span class=mi>0</span> <span class=o>-</span> <span class=nb>Number</span><span class=p>(</span><span class=mi>0</span> <span class=o>&gt;</span> <span class=nx>d</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>c</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=o>!</span><span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span>
</span></span><span class=line><span class=cl>            <span class=nx>c</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>c</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biHighIndex</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>b</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=mi>0</span> <span class=o>==</span> <span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>b</span><span class=p>];)</span>
</span></span><span class=line><span class=cl>        <span class=o>--</span><span class=nx>b</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biNumBits</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>b</span> <span class=o>=</span> <span class=nx>biHighIndex</span><span class=p>(</span><span class=nx>a</span><span class=p>),</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>b</span><span class=p>],</span> <span class=nx>d</span> <span class=o>=</span> <span class=p>(</span><span class=nx>b</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=nx>bitsPerDigit</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>e</span> <span class=o>=</span> <span class=nx>d</span><span class=p>;</span> <span class=nx>e</span> <span class=o>&gt;</span> <span class=nx>d</span> <span class=o>-</span> <span class=nx>bitsPerDigit</span> <span class=o>&amp;&amp;</span> <span class=mi>0</span> <span class=o>==</span> <span class=p>(</span><span class=mi>32768</span> <span class=o>&amp;</span> <span class=nx>c</span><span class=p>);</span> <span class=o>--</span><span class=nx>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span> <span class=o>&lt;&lt;=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>e</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biMultiply</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>k</span><span class=p>,</span> <span class=nx>c</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>,</span> <span class=nx>e</span> <span class=o>=</span> <span class=nx>biHighIndex</span><span class=p>(</span><span class=nx>a</span><span class=p>),</span> <span class=nx>f</span> <span class=o>=</span> <span class=nx>biHighIndex</span><span class=p>(</span><span class=nx>b</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>f</span> <span class=o>&gt;=</span> <span class=nx>k</span><span class=p>;</span> <span class=o>++</span><span class=nx>k</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=nx>d</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>i</span> <span class=o>=</span> <span class=nx>k</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>e</span> <span class=o>&gt;=</span> <span class=nx>j</span><span class=p>;</span> <span class=o>++</span><span class=nx>j</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=o>++</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>h</span> <span class=o>=</span> <span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=o>+</span> <span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=o>*</span> <span class=nx>b</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>k</span><span class=p>]</span> <span class=o>+</span> <span class=nx>d</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=o>=</span> <span class=nx>h</span> <span class=o>&amp;</span> <span class=nx>maxDigitVal</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>d</span> <span class=o>=</span> <span class=nx>h</span> <span class=o>&gt;&gt;&gt;</span> <span class=nx>biRadixBits</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>k</span> <span class=o>+</span> <span class=nx>e</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=nx>d</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>c</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>!=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biMultiplyDigit</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>f</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>result</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span> <span class=o>=</span> <span class=nx>biHighIndex</span><span class=p>(</span><span class=nx>a</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>f</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>c</span> <span class=o>&gt;=</span> <span class=nx>f</span><span class=p>;</span> <span class=o>++</span><span class=nx>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>e</span> <span class=o>=</span> <span class=nx>result</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span> <span class=o>+</span> <span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span> <span class=o>*</span> <span class=nx>b</span> <span class=o>+</span> <span class=nx>d</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>result</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span> <span class=o>=</span> <span class=nx>e</span> <span class=o>&amp;</span> <span class=nx>maxDigitVal</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>d</span> <span class=o>=</span> <span class=nx>e</span> <span class=o>&gt;&gt;&gt;</span> <span class=nx>biRadixBits</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>result</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=mi>1</span> <span class=o>+</span> <span class=nx>c</span><span class=p>]</span> <span class=o>=</span> <span class=nx>d</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>result</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>arrayCopy</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>f</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>min</span><span class=p>(</span><span class=nx>b</span> <span class=o>+</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>a</span><span class=p>.</span><span class=nx>length</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>g</span> <span class=o>=</span> <span class=nx>b</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>h</span> <span class=o>=</span> <span class=nx>d</span><span class=p>;</span> <span class=nx>f</span> <span class=o>&gt;</span> <span class=nx>g</span><span class=p>;</span> <span class=o>++</span><span class=nx>g</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=o>++</span><span class=nx>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span><span class=p>[</span><span class=nx>h</span><span class=p>]</span> <span class=o>=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>g</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biShiftLeft</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>c</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nx>b</span> <span class=o>/</span> <span class=nx>bitsPerDigit</span><span class=p>),</span> <span class=nx>d</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>arrayCopy</span><span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>d</span><span class=p>.</span><span class=nx>digits</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=nx>c</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>e</span> <span class=o>=</span> <span class=nx>b</span> <span class=o>%</span> <span class=nx>bitsPerDigit</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>f</span> <span class=o>=</span> <span class=nx>bitsPerDigit</span> <span class=o>-</span> <span class=nx>e</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>g</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>h</span> <span class=o>=</span> <span class=nx>g</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>g</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>;</span> <span class=o>--</span><span class=nx>g</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=o>--</span><span class=nx>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>g</span><span class=p>]</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>g</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=nx>e</span> <span class=o>&amp;</span> <span class=nx>maxDigitVal</span> <span class=o>|</span> <span class=p>(</span><span class=nx>d</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>h</span><span class=p>]</span> <span class=o>&amp;</span> <span class=nx>highBitMasks</span><span class=p>[</span><span class=nx>e</span><span class=p>])</span> <span class=o>&gt;&gt;&gt;</span> <span class=nx>f</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>d</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>g</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=nx>e</span> <span class=o>&amp;</span> <span class=nx>maxDigitVal</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biShiftRight</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>c</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nx>b</span> <span class=o>/</span> <span class=nx>bitsPerDigit</span><span class=p>),</span> <span class=nx>d</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>arrayCopy</span><span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>.</span><span class=nx>digits</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=nx>c</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>e</span> <span class=o>=</span> <span class=nx>b</span> <span class=o>%</span> <span class=nx>bitsPerDigit</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>f</span> <span class=o>=</span> <span class=nx>bitsPerDigit</span> <span class=o>-</span> <span class=nx>e</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>g</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>h</span> <span class=o>=</span> <span class=nx>g</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>g</span> <span class=o>&lt;</span> <span class=nx>d</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=o>++</span><span class=nx>g</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=o>++</span><span class=nx>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>g</span><span class=p>]</span> <span class=o>=</span> <span class=nx>d</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>g</span><span class=p>]</span> <span class=o>&gt;&gt;&gt;</span> <span class=nx>e</span> <span class=o>|</span> <span class=p>(</span><span class=nx>d</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>h</span><span class=p>]</span> <span class=o>&amp;</span> <span class=nx>lowBitMasks</span><span class=p>[</span><span class=nx>e</span><span class=p>])</span> <span class=o>&lt;&lt;</span> <span class=nx>f</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>d</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>d</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>&gt;&gt;&gt;=</span> <span class=nx>e</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biMultiplyByRadixPower</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>arrayCopy</span><span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=nx>b</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biDivideByRadixPower</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>arrayCopy</span><span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=nx>b</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biModuloByRadixPower</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>arrayCopy</span><span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>b</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biCompare</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>!=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span> <span class=o>-</span> <span class=mi>2</span> <span class=o>*</span> <span class=nb>Number</span><span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=nx>c</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=o>--</span><span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>c</span><span class=p>]</span> <span class=o>!=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>c</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>?</span> <span class=mi>1</span> <span class=o>-</span> <span class=mi>2</span> <span class=o>*</span> <span class=nb>Number</span><span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>c</span><span class=p>]</span> <span class=o>&gt;</span> <span class=nx>b</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>c</span><span class=p>])</span> <span class=o>:</span> <span class=mi>1</span> <span class=o>-</span> <span class=mi>2</span> <span class=o>*</span> <span class=nb>Number</span><span class=p>(</span><span class=nx>a</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>c</span><span class=p>]</span> <span class=o>&lt;</span> <span class=nx>b</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>c</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biDivideModulo</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>j</span><span class=p>,</span> <span class=nx>k</span><span class=p>,</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>m</span><span class=p>,</span> <span class=nx>n</span><span class=p>,</span> <span class=nx>o</span><span class=p>,</span> <span class=nx>p</span><span class=p>,</span> <span class=nx>q</span><span class=p>,</span> <span class=nx>r</span><span class=p>,</span> <span class=nx>s</span><span class=p>,</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>biNumBits</span><span class=p>(</span><span class=nx>a</span><span class=p>),</span> <span class=nx>d</span> <span class=o>=</span> <span class=nx>biNumBits</span><span class=p>(</span><span class=nx>b</span><span class=p>),</span> <span class=nx>e</span> <span class=o>=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>d</span> <span class=o>&gt;</span> <span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>?</span> <span class=p>(</span><span class=nx>f</span> <span class=o>=</span> <span class=nx>biCopy</span><span class=p>(</span><span class=nx>bigOne</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>f</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=o>!</span><span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=o>!</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=o>!</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>g</span> <span class=o>=</span> <span class=nx>biSubtract</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>a</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=o>!</span><span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>b</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=nx>e</span><span class=p>)</span> <span class=o>:</span> <span class=p>(</span><span class=nx>f</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>g</span> <span class=o>=</span> <span class=nx>biCopy</span><span class=p>(</span><span class=nx>a</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>            <span class=k>new</span> <span class=nb>Array</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>g</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>f</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>g</span> <span class=o>=</span> <span class=nx>a</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>h</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>ceil</span><span class=p>(</span><span class=nx>d</span> <span class=o>/</span> <span class=nx>bitsPerDigit</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>b</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>h</span><span class=p>]</span> <span class=o>&lt;</span> <span class=nx>biHalfRadix</span><span class=p>;)</span>
</span></span><span class=line><span class=cl>        <span class=nx>b</span> <span class=o>=</span> <span class=nx>biShiftLeft</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=o>++</span><span class=nx>i</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=o>++</span><span class=nx>d</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>h</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>ceil</span><span class=p>(</span><span class=nx>d</span> <span class=o>/</span> <span class=nx>bitsPerDigit</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>g</span> <span class=o>=</span> <span class=nx>biShiftLeft</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>i</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span> <span class=o>+=</span> <span class=nx>i</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>j</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>ceil</span><span class=p>(</span><span class=nx>c</span> <span class=o>/</span> <span class=nx>bitsPerDigit</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>k</span> <span class=o>=</span> <span class=nx>biMultiplyByRadixPower</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>j</span> <span class=o>-</span> <span class=nx>h</span><span class=p>);</span> <span class=o>-</span><span class=mi>1</span> <span class=o>!=</span> <span class=nx>biCompare</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>k</span><span class=p>);)</span>
</span></span><span class=line><span class=cl>        <span class=o>++</span><span class=nx>f</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>j</span> <span class=o>-</span> <span class=nx>h</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nx>g</span> <span class=o>=</span> <span class=nx>biSubtract</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>k</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>l</span> <span class=o>=</span> <span class=nx>j</span><span class=p>;</span> <span class=nx>l</span> <span class=o>&gt;</span> <span class=nx>h</span><span class=p>;</span> <span class=o>--</span><span class=nx>l</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=nx>m</span> <span class=o>=</span> <span class=nx>l</span> <span class=o>&gt;=</span> <span class=nx>g</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>length</span> <span class=o>?</span> <span class=mi>0</span> <span class=o>:</span> <span class=nx>g</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>l</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nx>n</span> <span class=o>=</span> <span class=nx>l</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>&gt;=</span> <span class=nx>g</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>length</span> <span class=o>?</span> <span class=mi>0</span> <span class=o>:</span> <span class=nx>g</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>l</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nx>o</span> <span class=o>=</span> <span class=nx>l</span> <span class=o>-</span> <span class=mi>2</span> <span class=o>&gt;=</span> <span class=nx>g</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>length</span> <span class=o>?</span> <span class=mi>0</span> <span class=o>:</span> <span class=nx>g</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>l</span> <span class=o>-</span> <span class=mi>2</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nx>p</span> <span class=o>=</span> <span class=nx>h</span> <span class=o>&gt;=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>length</span> <span class=o>?</span> <span class=mi>0</span> <span class=o>:</span> <span class=nx>b</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>h</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nx>q</span> <span class=o>=</span> <span class=nx>h</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>&gt;=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>digits</span><span class=p>.</span><span class=nx>length</span> <span class=o>?</span> <span class=mi>0</span> <span class=o>:</span> <span class=nx>b</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>h</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nx>f</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>l</span> <span class=o>-</span> <span class=nx>h</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=nx>m</span> <span class=o>==</span> <span class=nx>p</span> <span class=o>?</span> <span class=nx>maxDigitVal</span> <span class=o>:</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>((</span><span class=nx>m</span> <span class=o>*</span> <span class=nx>biRadix</span> <span class=o>+</span> <span class=nx>n</span><span class=p>)</span> <span class=o>/</span> <span class=nx>p</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>r</span> <span class=o>=</span> <span class=nx>f</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>l</span> <span class=o>-</span> <span class=nx>h</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=p>(</span><span class=nx>p</span> <span class=o>*</span> <span class=nx>biRadix</span> <span class=o>+</span> <span class=nx>q</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>s</span> <span class=o>=</span> <span class=nx>m</span> <span class=o>*</span> <span class=nx>biRadixSquared</span> <span class=o>+</span> <span class=p>(</span><span class=nx>n</span> <span class=o>*</span> <span class=nx>biRadix</span> <span class=o>+</span> <span class=nx>o</span><span class=p>);</span> <span class=nx>r</span> <span class=o>&gt;</span> <span class=nx>s</span><span class=p>;)</span>
</span></span><span class=line><span class=cl>            <span class=o>--</span><span class=nx>f</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>l</span> <span class=o>-</span> <span class=nx>h</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=nx>r</span> <span class=o>=</span> <span class=nx>f</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>l</span> <span class=o>-</span> <span class=nx>h</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=p>(</span><span class=nx>p</span> <span class=o>*</span> <span class=nx>biRadix</span> <span class=o>|</span> <span class=nx>q</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=nx>s</span> <span class=o>=</span> <span class=nx>m</span> <span class=o>*</span> <span class=nx>biRadix</span> <span class=o>*</span> <span class=nx>biRadix</span> <span class=o>+</span> <span class=p>(</span><span class=nx>n</span> <span class=o>*</span> <span class=nx>biRadix</span> <span class=o>+</span> <span class=nx>o</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>k</span> <span class=o>=</span> <span class=nx>biMultiplyByRadixPower</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>l</span> <span class=o>-</span> <span class=nx>h</span> <span class=o>-</span> <span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>g</span> <span class=o>=</span> <span class=nx>biSubtract</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>biMultiplyDigit</span><span class=p>(</span><span class=nx>k</span><span class=p>,</span> <span class=nx>f</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>l</span> <span class=o>-</span> <span class=nx>h</span> <span class=o>-</span> <span class=mi>1</span><span class=p>])),</span>
</span></span><span class=line><span class=cl>            <span class=nx>g</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nx>g</span> <span class=o>=</span> <span class=nx>biAdd</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>k</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=o>--</span><span class=nx>f</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>l</span> <span class=o>-</span> <span class=nx>h</span> <span class=o>-</span> <span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>g</span> <span class=o>=</span> <span class=nx>biShiftRight</span><span class=p>(</span><span class=nx>g</span><span class=p>,</span> <span class=nx>i</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>f</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>!=</span> <span class=nx>e</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>a</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nx>f</span> <span class=o>=</span> <span class=nx>e</span> <span class=o>?</span> <span class=nx>biAdd</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>bigOne</span><span class=p>)</span> <span class=o>:</span> <span class=nx>biSubtract</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>bigOne</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>b</span> <span class=o>=</span> <span class=nx>biShiftRight</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>i</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>g</span> <span class=o>=</span> <span class=nx>biSubtract</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>g</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span> <span class=o>==</span> <span class=nx>g</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=mi>0</span> <span class=o>==</span> <span class=nx>biHighIndex</span><span class=p>(</span><span class=nx>g</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nx>g</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>=</span> <span class=o>!</span><span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=nb>Array</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=nx>g</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biDivide</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>biDivideModulo</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biModulo</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>biDivideModulo</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biMultiplyMod</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>biModulo</span><span class=p>(</span><span class=nx>biMultiply</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>),</span> <span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biPow</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>bigOne</span><span class=p>,</span> <span class=nx>d</span> <span class=o>=</span> <span class=nx>a</span><span class=p>;</span> <span class=p>;)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=mi>0</span> <span class=o>!=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&amp;</span> <span class=nx>b</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nx>c</span> <span class=o>=</span> <span class=nx>biMultiply</span><span class=p>(</span><span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>            <span class=nx>b</span> <span class=o>&gt;&gt;=</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=mi>0</span> <span class=o>==</span> <span class=nx>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span> <span class=o>=</span> <span class=nx>biMultiply</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>c</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>biPowMod</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>d</span> <span class=o>=</span> <span class=nx>bigOne</span><span class=p>,</span> <span class=nx>e</span> <span class=o>=</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>f</span> <span class=o>=</span> <span class=nx>b</span><span class=p>;</span> <span class=p>;)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=mi>0</span> <span class=o>!=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&amp;</span> <span class=nx>f</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nx>d</span> <span class=o>=</span> <span class=nx>biMultiplyMod</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>c</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>            <span class=nx>f</span> <span class=o>=</span> <span class=nx>biShiftRight</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=mi>0</span> <span class=o>==</span> <span class=nx>f</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=mi>0</span> <span class=o>==</span> <span class=nx>biHighIndex</span><span class=p>(</span><span class=nx>f</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>e</span> <span class=o>=</span> <span class=nx>biMultiplyMod</span><span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>d</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>BarrettMu</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>modulus</span> <span class=o>=</span> <span class=nx>biCopy</span><span class=p>(</span><span class=nx>a</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>k</span> <span class=o>=</span> <span class=nx>biHighIndex</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>modulus</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>b</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=mi>2</span> <span class=o>*</span> <span class=k>this</span><span class=p>.</span><span class=nx>k</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>mu</span> <span class=o>=</span> <span class=nx>biDivide</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>modulus</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>bkplus1</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>bkplus1</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=k>this</span><span class=p>.</span><span class=nx>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>modulo</span> <span class=o>=</span> <span class=nx>BarrettMu_modulo</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>multiplyMod</span> <span class=o>=</span> <span class=nx>BarrettMu_multiplyMod</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>powMod</span> <span class=o>=</span> <span class=nx>BarrettMu_powMod</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>BarrettMu_modulo</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>b</span> <span class=o>=</span> <span class=nx>biDivideByRadixPower</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>k</span> <span class=o>-</span> <span class=mi>1</span><span class=p>),</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>biMultiply</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>mu</span><span class=p>),</span> <span class=nx>d</span> <span class=o>=</span> <span class=nx>biDivideByRadixPower</span><span class=p>(</span><span class=nx>c</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span> <span class=nx>e</span> <span class=o>=</span> <span class=nx>biModuloByRadixPower</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span> <span class=nx>f</span> <span class=o>=</span> <span class=nx>biMultiply</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>modulus</span><span class=p>),</span> <span class=nx>g</span> <span class=o>=</span> <span class=nx>biModuloByRadixPower</span><span class=p>(</span><span class=nx>f</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>k</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span> <span class=nx>h</span> <span class=o>=</span> <span class=nx>biSubtract</span><span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>g</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>h</span><span class=p>.</span><span class=nx>isNeg</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nx>h</span> <span class=o>=</span> <span class=nx>biAdd</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>bkplus1</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>        <span class=nx>i</span> <span class=o>=</span> <span class=nx>biCompare</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>modulus</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span><span class=p>;)</span>
</span></span><span class=line><span class=cl>        <span class=nx>h</span> <span class=o>=</span> <span class=nx>biSubtract</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>modulus</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>i</span> <span class=o>=</span> <span class=nx>biCompare</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>modulus</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>h</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>BarrettMu_multiplyMod</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>biMultiply</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>modulo</span><span class=p>(</span><span class=nx>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>BarrettMu_powMod</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>c</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>c</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span> <span class=o>=</span> <span class=nx>a</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>e</span> <span class=o>=</span> <span class=nx>b</span><span class=p>;</span> <span class=p>;)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=mi>0</span> <span class=o>!=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&amp;</span> <span class=nx>e</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nx>c</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>multiplyMod</span><span class=p>(</span><span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>            <span class=nx>e</span> <span class=o>=</span> <span class=nx>biShiftRight</span><span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=mi>0</span> <span class=o>==</span> <span class=nx>e</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=mi>0</span> <span class=o>==</span> <span class=nx>biHighIndex</span><span class=p>(</span><span class=nx>e</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>multiplyMod</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>c</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>maxDigits</span><span class=p>,</span> <span class=nx>ZERO_ARRAY</span><span class=p>,</span> <span class=nx>bigZero</span><span class=p>,</span> <span class=nx>bigOne</span><span class=p>,</span> <span class=nx>dpl10</span><span class=p>,</span> <span class=nx>lr10</span><span class=p>,</span> <span class=nx>hexatrigesimalToChar</span><span class=p>,</span> <span class=nx>hexToChar</span><span class=p>,</span> <span class=nx>highBitMasks</span><span class=p>,</span> <span class=nx>lowBitMasks</span><span class=p>,</span> <span class=nx>biRadixBase</span> <span class=o>=</span> <span class=mi>2</span><span class=p>,</span> <span class=nx>biRadixBits</span> <span class=o>=</span> <span class=mi>16</span><span class=p>,</span> <span class=nx>bitsPerDigit</span> <span class=o>=</span> <span class=nx>biRadixBits</span><span class=p>,</span> <span class=nx>biRadix</span> <span class=o>=</span> <span class=mi>65536</span><span class=p>,</span> <span class=nx>biHalfRadix</span> <span class=o>=</span> <span class=nx>biRadix</span> <span class=o>&gt;&gt;&gt;</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>biRadixSquared</span> <span class=o>=</span> <span class=nx>biRadix</span> <span class=o>*</span> <span class=nx>biRadix</span><span class=p>,</span> <span class=nx>maxDigitVal</span> <span class=o>=</span> <span class=nx>biRadix</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>maxInteger</span> <span class=o>=</span> <span class=mi>9999999999999998</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>setMaxDigits</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>dpl10</span> <span class=o>=</span> <span class=mi>15</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>lr10</span> <span class=o>=</span> <span class=nx>biFromNumber</span><span class=p>(</span><span class=mf>1e15</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>hexatrigesimalToChar</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Array</span><span class=p>(</span><span class=s2>&#34;0&#34;</span><span class=p>,</span> <span class=s2>&#34;1&#34;</span><span class=p>,</span> <span class=s2>&#34;2&#34;</span><span class=p>,</span> <span class=s2>&#34;3&#34;</span><span class=p>,</span> <span class=s2>&#34;4&#34;</span><span class=p>,</span> <span class=s2>&#34;5&#34;</span><span class=p>,</span> <span class=s2>&#34;6&#34;</span><span class=p>,</span> <span class=s2>&#34;7&#34;</span><span class=p>,</span> <span class=s2>&#34;8&#34;</span><span class=p>,</span> <span class=s2>&#34;9&#34;</span><span class=p>,</span> <span class=s2>&#34;a&#34;</span><span class=p>,</span> <span class=s2>&#34;b&#34;</span><span class=p>,</span> <span class=s2>&#34;c&#34;</span><span class=p>,</span> <span class=s2>&#34;d&#34;</span><span class=p>,</span> <span class=s2>&#34;e&#34;</span><span class=p>,</span> <span class=s2>&#34;f&#34;</span><span class=p>,</span> <span class=s2>&#34;g&#34;</span><span class=p>,</span> <span class=s2>&#34;h&#34;</span><span class=p>,</span> <span class=s2>&#34;i&#34;</span><span class=p>,</span> <span class=s2>&#34;j&#34;</span><span class=p>,</span> <span class=s2>&#34;k&#34;</span><span class=p>,</span> <span class=s2>&#34;l&#34;</span><span class=p>,</span> <span class=s2>&#34;m&#34;</span><span class=p>,</span> <span class=s2>&#34;n&#34;</span><span class=p>,</span> <span class=s2>&#34;o&#34;</span><span class=p>,</span> <span class=s2>&#34;p&#34;</span><span class=p>,</span> <span class=s2>&#34;q&#34;</span><span class=p>,</span> <span class=s2>&#34;r&#34;</span><span class=p>,</span> <span class=s2>&#34;s&#34;</span><span class=p>,</span> <span class=s2>&#34;t&#34;</span><span class=p>,</span> <span class=s2>&#34;u&#34;</span><span class=p>,</span> <span class=s2>&#34;v&#34;</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>,</span> <span class=s2>&#34;x&#34;</span><span class=p>,</span> <span class=s2>&#34;y&#34;</span><span class=p>,</span> <span class=s2>&#34;z&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>hexToChar</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Array</span><span class=p>(</span><span class=s2>&#34;0&#34;</span><span class=p>,</span> <span class=s2>&#34;1&#34;</span><span class=p>,</span> <span class=s2>&#34;2&#34;</span><span class=p>,</span> <span class=s2>&#34;3&#34;</span><span class=p>,</span> <span class=s2>&#34;4&#34;</span><span class=p>,</span> <span class=s2>&#34;5&#34;</span><span class=p>,</span> <span class=s2>&#34;6&#34;</span><span class=p>,</span> <span class=s2>&#34;7&#34;</span><span class=p>,</span> <span class=s2>&#34;8&#34;</span><span class=p>,</span> <span class=s2>&#34;9&#34;</span><span class=p>,</span> <span class=s2>&#34;a&#34;</span><span class=p>,</span> <span class=s2>&#34;b&#34;</span><span class=p>,</span> <span class=s2>&#34;c&#34;</span><span class=p>,</span> <span class=s2>&#34;d&#34;</span><span class=p>,</span> <span class=s2>&#34;e&#34;</span><span class=p>,</span> <span class=s2>&#34;f&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>highBitMasks</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Array</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>32768</span><span class=p>,</span> <span class=mi>49152</span><span class=p>,</span> <span class=mi>57344</span><span class=p>,</span> <span class=mi>61440</span><span class=p>,</span> <span class=mi>63488</span><span class=p>,</span> <span class=mi>64512</span><span class=p>,</span> <span class=mi>65024</span><span class=p>,</span> <span class=mi>65280</span><span class=p>,</span> <span class=mi>65408</span><span class=p>,</span> <span class=mi>65472</span><span class=p>,</span> <span class=mi>65504</span><span class=p>,</span> <span class=mi>65520</span><span class=p>,</span> <span class=mi>65528</span><span class=p>,</span> <span class=mi>65532</span><span class=p>,</span> <span class=mi>65534</span><span class=p>,</span> <span class=mi>65535</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>lowBitMasks</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Array</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>31</span><span class=p>,</span> <span class=mi>63</span><span class=p>,</span> <span class=mi>127</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>511</span><span class=p>,</span> <span class=mi>1023</span><span class=p>,</span> <span class=mi>2047</span><span class=p>,</span> <span class=mi>4095</span><span class=p>,</span> <span class=mi>8191</span><span class=p>,</span> <span class=mi>16383</span><span class=p>,</span> <span class=mi>32767</span><span class=p>,</span> <span class=mi>65535</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>generate</span><span class=p>(</span><span class=nx>id</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>x</span> <span class=o>=</span> <span class=s2>&#34;{\&#34;hlpretag\&#34;:\&#34;&lt;span class=\\\&#34;s-fc7\\\&#34;&gt;\&#34;,\&#34;hlposttag\&#34;:\&#34;&lt;/span&gt;\&#34;,\&#34;id\&#34;:\&#34;19723756\&#34;,\&#34;s\&#34;:\&#34;daddydaddydo\&#34;,\&#34;type\&#34;:\&#34;1\&#34;,\&#34;offset\&#34;:\&#34;0\&#34;,\&#34;total\&#34;:\&#34;true\&#34;,\&#34;limit\&#34;:\&#34;30\&#34;,\&#34;csrf_token\&#34;:\&#34;\&#34;}&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>bUE3x</span> <span class=o>=</span> <span class=nx>d</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=s2>&#34;010001&#34;</span><span class=p>,</span> <span class=s2>&#34;00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7&#34;</span><span class=p>,</span> <span class=s2>&#34;0CoJUm6Qyw8W8jud&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>params</span> <span class=o>=</span> <span class=nx>bUE3x</span><span class=p>.</span><span class=nx>encText</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>encSecKey</span> <span class=o>=</span> <span class=nx>bUE3x</span><span class=p>.</span><span class=nx>encSecKey</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>params</span><span class=o>:</span> <span class=nx>params</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>encSecKey</span><span class=o>:</span> <span class=nx>encSecKey</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>a</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// var d, e, b = &#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#34;,
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// c = &#34;&#34;;
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// for (d = 0; a &gt; d; d += 1) e = Math.random() * b.length,
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// e = Math.floor(e),
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// c += b.charAt(e);
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// return c
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=s2>&#34;29MLTcVbKsvktpRV&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>b</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>enc</span><span class=p>.</span><span class=nx>Utf8</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>b</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>enc</span><span class=p>.</span><span class=nx>Utf8</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=s2>&#34;0102030405060708&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>e</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>enc</span><span class=p>.</span><span class=nx>Utf8</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>a</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>f</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>AES</span><span class=p>.</span><span class=nx>encrypt</span><span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>iv</span><span class=o>:</span> <span class=nx>d</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>mode</span><span class=o>:</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>mode</span><span class=p>.</span><span class=nx>CBC</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>f</span><span class=p>.</span><span class=nx>toString</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>c</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>setMaxDigits</span><span class=p>(</span><span class=mi>131</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>RSAKeyPair</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=nx>c</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>e</span> <span class=o>=</span> <span class=nx>encryptedString</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>d</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>g</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>h</span> <span class=o>=</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>        <span class=nx>i</span> <span class=o>=</span> <span class=nx>a</span><span class=p>(</span><span class=mi>16</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>h</span><span class=p>.</span><span class=nx>encText</span> <span class=o>=</span> <span class=nx>b</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>g</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>h</span><span class=p>.</span><span class=nx>encText</span> <span class=o>=</span> <span class=nx>b</span><span class=p>(</span><span class=nx>h</span><span class=p>.</span><span class=nx>encText</span><span class=p>,</span> <span class=nx>i</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>h</span><span class=p>.</span><span class=nx>encSecKey</span> <span class=o>=</span> <span class=nx>c</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>e</span><span class=p>,</span> <span class=nx>f</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>h</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>gen</span> <span class=o>=</span> <span class=nx>generate</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>gen</span><span class=p>.</span><span class=nx>params</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>gen</span><span class=p>.</span><span class=nx>encSecKey</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=调试>调试</h4><p>新建一个 html 来引入这个 js 文件，每次刷新 html 的时候就可以进行一次调试啦。比在云音乐网页上调试方便多了。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#39;utf-8&#39;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>http-equiv</span><span class=o>=</span><span class=s>&#39;X-UA-Compatible&#39;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#39;IE=edge&#39;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#39;viewport&#39;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#39;width=device-width, initial-scale=1&#39;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#39;test.js&#39;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>JK suki<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=分析-aes-加密>分析 AES 加密</h2><p>AES 加密集中在 <code>b</code> 方法</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>b</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>enc</span><span class=p>.</span><span class=nx>Utf8</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>b</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>d</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>enc</span><span class=p>.</span><span class=nx>Utf8</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=s2>&#34;0102030405060708&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>e</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>enc</span><span class=p>.</span><span class=nx>Utf8</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>a</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>f</span> <span class=o>=</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>AES</span><span class=p>.</span><span class=nx>encrypt</span><span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>iv</span><span class=o>:</span> <span class=nx>d</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>mode</span><span class=o>:</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>mode</span><span class=p>.</span><span class=nx>CBC</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>f</span><span class=p>.</span><span class=nx>toString</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>这个看起来还是比较好懂，主要是对各种加密方式的参数熟悉一些就可以发现了。</p><ul><li>CryptoJS.enc.Utf8 就是将字符串按 UTF8 格式解码成字节数组</li><li>CryptoJS.AES.encrypt 是实际的加密方法，从上下文推断，第一个参数会传入原始的 <code>params</code>，所以第一个参数是原文，第二个参数是 key</li><li>iv 是 AES 加密用到的 <code>salt</code></li></ul><p>返回的结果是 <code>f.toString</code>。我原本以为是返回 HEX 字符串，但观察正确的输出可以得知是 <code>Base64</code> 的 <code>Mime</code> 格式(末尾的 <code>=</code> 和 中间出现的 <code>/</code> 给了我们提示)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=s2>&#34;fS15fDwPSPzRvd8OYwEnU2P/l/11+QKvMzWEy/EOn2RpIFXFYuDnEJrioOK25vaUCKckA2MPliSOq6gT5DtWQvEYq15QPvzphiPEUrd8Oj+UhTvOAfRE8v8gyrc8Ik5w6RyqosC3SqapEgPTagS0+l6yxhgwz8sWhL9yMn3SpgCJcnQ94YdKbxXVwpwXrO54HLHJSwzhKRECVsPU4rU+dvMbP2Z2x6HHUlOC3WYWdGkaj7h3PYivOKq3/yPgKyp9uExonxdn6aSAR46v5NSRk+6g+fqt9hR/UuKDXtKXVtbBGOFUbb/8Ns+m4Hj7k1Js&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>一切都是猜测，我们用 Java 代码模拟一下输出</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=n>String</span> <span class=nf>getAES</span><span class=o>(</span><span class=n>String</span> <span class=n>input</span><span class=o>,</span> <span class=n>String</span> <span class=n>key</span><span class=o>,</span> <span class=n>String</span> <span class=n>salt</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>AES</span> <span class=n>aes</span> <span class=o>=</span> <span class=k>new</span> <span class=n>AES</span><span class=o>(</span><span class=n>Mode</span><span class=o>.</span><span class=na>CBC</span><span class=o>,</span> <span class=n>Padding</span><span class=o>.</span><span class=na>PKCS5Padding</span><span class=o>,</span> <span class=n>key</span><span class=o>.</span><span class=na>getBytes</span><span class=o>(),</span> <span class=n>salt</span><span class=o>.</span><span class=na>getBytes</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=kt>byte</span><span class=o>[]</span> <span class=n>encrypt</span> <span class=o>=</span> <span class=n>aes</span><span class=o>.</span><span class=na>encrypt</span><span class=o>(</span><span class=n>input</span><span class=o>.</span><span class=na>getBytes</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>Base64</span><span class=o>.</span><span class=na>getMimeEncoder</span><span class=o>(</span><span class=n>Integer</span><span class=o>.</span><span class=na>MAX_VALUE</span><span class=o>,</span> <span class=k>new</span> <span class=kt>byte</span><span class=o>[</span><span class=n>0</span><span class=o>]).</span><span class=na>encodeToString</span><span class=o>(</span><span class=n>encrypt</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>json</span> <span class=o>=</span> <span class=s>&#34;{\&#34;hlpretag\&#34;:\&#34;&lt;span class=\\\&#34;s-fc7\\\&#34;&gt;\&#34;,\&#34;hlposttag\&#34;:\&#34;&lt;/span&gt;\&#34;,\&#34;id\&#34;:\&#34;19723756\&#34;,\&#34;s\&#34;:\&#34;daddydaddydo\&#34;,\&#34;type\&#34;:\&#34;1\&#34;,\&#34;offset\&#34;:\&#34;0\&#34;,\&#34;total\&#34;:\&#34;true\&#34;,\&#34;limit\&#34;:\&#34;30\&#34;,\&#34;csrf_token\&#34;:\&#34;\&#34;}&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>k3</span> <span class=o>=</span> <span class=s>&#34;0CoJUm6Qyw8W8jud&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>salt</span> <span class=o>=</span> <span class=s>&#34;0102030405060708&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>res</span> <span class=o>=</span> <span class=n>getAES</span><span class=o>(</span><span class=n>json</span><span class=o>,</span> <span class=o>,</span> <span class=n>k3</span><span class=o>,</span> <span class=n>salt</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>res</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>输出结果完美匹配。</p><blockquote><p>其实这里还是有一点小插曲。AES 加密需要满足原文长度是一定的整数倍，如果不满足整数倍，就需要将原文填充。而填充的方式有很多种，常见的是用0填充。然而用0填充会发现最后的 <code>Base64</code> 在最后几个字符不匹配。在末尾不匹配，立马就应该想到是末尾填充的问题。所幸，填充的方式只有有限几种，穷举一下匹配就能得到结果了。正如代码里看到了，正确的填充方式选用了 PKCS5Padding。</p></blockquote><h2 id=奇怪的-rsa-算法>奇怪的 RSA 算法</h2><p>RSA 算法的代码在 <code>c</code> 方法里</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>c</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>setMaxDigits</span><span class=p>(</span><span class=mi>131</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>d</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>RSAKeyPair</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span><span class=s2>&#34;&#34;</span><span class=p>,</span><span class=nx>c</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>e</span> <span class=o>=</span> <span class=nx>encryptedString</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>encryptedString</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>f</span><span class=p>,</span> <span class=nx>g</span><span class=p>,</span> <span class=nx>h</span><span class=p>,</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>j</span><span class=p>,</span> <span class=nx>k</span><span class=p>,</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>c</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Array</span><span class=p>,</span> <span class=nx>d</span> <span class=o>=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>length</span><span class=p>,</span> <span class=nx>e</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>d</span> <span class=o>&gt;</span> <span class=nx>e</span><span class=p>;)</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span><span class=p>[</span><span class=nx>e</span><span class=p>]</span> <span class=o>=</span> <span class=nx>b</span><span class=p>.</span><span class=nx>charCodeAt</span><span class=p>(</span><span class=nx>e</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>e</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(;</span> <span class=mi>0</span> <span class=o>!=</span> <span class=nx>c</span><span class=p>.</span><span class=nx>length</span> <span class=o>%</span> <span class=nx>a</span><span class=p>.</span><span class=nx>chunkSize</span><span class=p>;)</span>
</span></span><span class=line><span class=cl>        <span class=nx>c</span><span class=p>[</span><span class=nx>e</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nx>f</span> <span class=o>=</span> <span class=nx>c</span><span class=p>.</span><span class=nx>length</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>g</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>e</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>f</span> <span class=o>&gt;</span> <span class=nx>e</span><span class=p>;</span> <span class=nx>e</span> <span class=o>+=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>chunkSize</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=nx>j</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>BigInt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>h</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>i</span> <span class=o>=</span> <span class=nx>e</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>e</span> <span class=o>+</span> <span class=nx>a</span><span class=p>.</span><span class=nx>chunkSize</span><span class=p>;</span> <span class=o>++</span><span class=nx>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>j</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>h</span><span class=p>]</span> <span class=o>=</span> <span class=nx>c</span><span class=p>[</span><span class=nx>i</span><span class=o>++</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=nx>j</span><span class=p>.</span><span class=nx>digits</span><span class=p>[</span><span class=nx>h</span><span class=p>]</span> <span class=o>+=</span> <span class=nx>c</span><span class=p>[</span><span class=nx>i</span><span class=o>++</span><span class=p>]</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>k</span> <span class=o>=</span> <span class=nx>a</span><span class=p>.</span><span class=nx>barrett</span><span class=p>.</span><span class=nx>powMod</span><span class=p>(</span><span class=nx>j</span><span class=p>,</span> <span class=nx>a</span><span class=p>.</span><span class=nx>e</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>l</span> <span class=o>=</span> <span class=mi>16</span> <span class=o>==</span> <span class=nx>a</span><span class=p>.</span><span class=nx>radix</span> <span class=o>?</span> <span class=nx>biToHex</span><span class=p>(</span><span class=nx>k</span><span class=p>)</span> <span class=o>:</span> <span class=nx>biToString</span><span class=p>(</span><span class=nx>k</span><span class=p>,</span> <span class=nx>a</span><span class=p>.</span><span class=nx>radix</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>g</span> <span class=o>+=</span> <span class=nx>l</span> <span class=o>+</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>g</span><span class=p>.</span><span class=nx>substring</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>g</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>简单分析下这两个方法，<code>c</code> 方法里生成了一个 <code>KeyPair</code>, 可以肯定，这个就是密钥。RSA的密钥由三个大数组成(n, p, q)，其中 (n, p), (n, q) 分别构成了公钥和私钥。在客户端加密中，一般是不出现私钥的，所以这里传了空。RSA 加密中 n 是一个很大的合数，由此可以确定 <code>keyPair</code> 三个参数的实际意义。</p><p><code>encryptedString</code> 传入了密钥和明文进行加密。其中，明文是之前生成的随机数。</p><p><code>encryptedString</code> 中对随机数依次取得 ascii 编码(第一个 for)，并将数组长度扩充到 chunkSize(第二个 for)。通过 debug 可以得知 chunkSize 的值是 126。</p><p>接下来的两个嵌套的 for 循环，将长度 126 的字节数组转换成了一个 <code>BigInt</code>。通过查看 <code>BigInt</code> 的相关代码可以得知，<code>BigInt</code> 的一个 int 数组，用来模拟一个 65536(0xFFFF) 进制的大整数。且所有以 <code>bi</code> 开头的函数，都是辅助这个 <code>BigInt</code> 类型进行大数计算的函数。</p><p>这里将随机数字符串转换成 <code>BigInt</code> 的逻辑，是将字符串每两个字符，一个作为高8位，一个作为低8位，构成 <code>BigInt</code> 的一个 65536 进制位，从低位开始填充(h++)。这显然不是一个常规方法。那其实就是一个以 ASCII 为基础的 65536 整数，每个字符表示 8 位。(HEX 是每个字符表示 4 位)</p><p>之后核心逻辑只剩下一个，<code>powMod</code>。<code>powMod</code> 也是 RSA 的核心计算，这里就显得十分直观了。根据 RSA 的原理</p><p>$$ 密文 = 原文^p \mod n $$</p><p>这里的 <code>a.e</code> 应该就是公钥了, <code>j</code> 是从字符串转成了 <code>BigInt</code> 的原文。根据公式计算出结果后，在取 Hex 字符串就好了</p><p>用 Java 代码验证</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=n>String</span> <span class=nf>getRSA</span><span class=o>(</span><span class=n>String</span> <span class=n>input</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>BigInteger</span> <span class=n>k1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BigInteger</span><span class=o>(</span><span class=s>&#34;010001&#34;</span><span class=o>,</span> <span class=n>16</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>BigInteger</span> <span class=n>k2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BigInteger</span><span class=o>(</span><span class=s>&#34;00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7&#34;</span><span class=o>,</span> <span class=n>16</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>BigInteger</span> <span class=n>b</span> <span class=o>=</span> <span class=n>getB</span><span class=o>(</span><span class=n>input</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>BigInteger</span> <span class=n>mod</span> <span class=o>=</span> <span class=n>b</span><span class=o>.</span><span class=na>modPow</span><span class=o>(</span><span class=n>k1</span><span class=o>,</span> <span class=n>k2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>mod</span><span class=o>.</span><span class=na>toString</span><span class=o>(</span><span class=n>16</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=n>BigInteger</span> <span class=nf>getB</span><span class=o>(</span><span class=n>String</span> <span class=n>input</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>BigInteger</span> <span class=n>res</span> <span class=o>=</span> <span class=n>BigInteger</span><span class=o>.</span><span class=na>ZERO</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>input</span><span class=o>.</span><span class=na>length</span><span class=o>();</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>input</span><span class=o>.</span><span class=na>charAt</span><span class=o>(</span><span class=n>i</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>BigInteger</span> <span class=n>bi</span> <span class=o>=</span> <span class=n>BigInteger</span><span class=o>.</span><span class=na>valueOf</span><span class=o>(</span><span class=n>b</span><span class=o>).</span><span class=na>shiftLeft</span><span class=o>(</span><span class=n>i</span> <span class=o>*</span> <span class=n>8</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=na>or</span><span class=o>(</span><span class=n>bi</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>res</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>random</span> <span class=o>=</span> <span class=s>&#34;29MLTcVbKsvktpRV&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>res</span> <span class=o>=</span> <span class=n>getRSA</span><span class=o>(</span><span class=n>random</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>res</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>结果也是完美匹配。</p><blockquote><p>中间当然也是有小插曲的。最初尝试的时候，使用标准的 RSA 库去实现。但是 RSA 是一个多次迭代且会加入随机值的加密算法。而网页接口里的 RSA 只使用了依次迭代就完成了加密，显然和标准的 RSA 还是有一点区别的。文中的代码，也是反复测试和分析代码才得出来的结果。</p></blockquote><h2 id=尾声>尾声</h2><p>至此，所有代码已经分析完成，一下展示完整的 Java 实现</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Music</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>input</span> <span class=o>=</span> <span class=s>&#34;{\&#34;hlpretag\&#34;:\&#34;&lt;span class=\\\&#34;s-fc7\\\&#34;&gt;\&#34;,\&#34;hlposttag\&#34;:\&#34;&lt;/span&gt;\&#34;,\&#34;id\&#34;:\&#34;19723756\&#34;,\&#34;s\&#34;:\&#34;daddydaddydo\&#34;,\&#34;type\&#34;:\&#34;1\&#34;,\&#34;offset\&#34;:\&#34;0\&#34;,\&#34;total\&#34;:\&#34;true\&#34;,\&#34;limit\&#34;:\&#34;30\&#34;,\&#34;csrf_token\&#34;:\&#34;\&#34;}&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>random</span> <span class=o>=</span> <span class=s>&#34;29MLTcVbKsvktpRV&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>aes</span> <span class=o>=</span> <span class=n>getAES</span><span class=o>(</span><span class=n>input</span><span class=o>,</span> <span class=s>&#34;0CoJUm6Qyw8W8jud&#34;</span><span class=o>,</span> <span class=s>&#34;0102030405060708&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>text</span> <span class=o>=</span> <span class=n>getAES</span><span class=o>(</span><span class=n>aes</span><span class=o>,</span> <span class=n>random</span><span class=o>,</span> <span class=s>&#34;0102030405060708&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>rsa</span> <span class=o>=</span> <span class=n>getRSA</span><span class=o>(</span><span class=n>random</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>text</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>rsa</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>String</span> <span class=nf>getAES</span><span class=o>(</span><span class=n>String</span> <span class=n>input</span><span class=o>,</span> <span class=n>String</span> <span class=n>key</span><span class=o>,</span> <span class=n>String</span> <span class=n>salt</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>AES</span> <span class=n>aes</span> <span class=o>=</span> <span class=k>new</span> <span class=n>AES</span><span class=o>(</span><span class=n>Mode</span><span class=o>.</span><span class=na>CBC</span><span class=o>,</span> <span class=n>Padding</span><span class=o>.</span><span class=na>PKCS5Padding</span><span class=o>,</span> <span class=n>key</span><span class=o>.</span><span class=na>getBytes</span><span class=o>(),</span> <span class=n>salt</span><span class=o>.</span><span class=na>getBytes</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=kt>byte</span><span class=o>[]</span> <span class=n>encrypt</span> <span class=o>=</span> <span class=n>aes</span><span class=o>.</span><span class=na>encrypt</span><span class=o>(</span><span class=n>input</span><span class=o>.</span><span class=na>getBytes</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Base64</span><span class=o>.</span><span class=na>getMimeEncoder</span><span class=o>(</span><span class=n>Integer</span><span class=o>.</span><span class=na>MAX_VALUE</span><span class=o>,</span> <span class=k>new</span> <span class=kt>byte</span><span class=o>[</span><span class=n>0</span><span class=o>]).</span><span class=na>encodeToString</span><span class=o>(</span><span class=n>encrypt</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>String</span> <span class=nf>getRSA</span><span class=o>(</span><span class=n>String</span> <span class=n>input</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// p
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>BigInteger</span> <span class=n>v1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BigInteger</span><span class=o>(</span><span class=s>&#34;010001&#34;</span><span class=o>,</span> <span class=n>16</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// n
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>BigInteger</span> <span class=n>v2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BigInteger</span><span class=o>(</span><span class=s>&#34;00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7&#34;</span><span class=o>,</span> <span class=n>16</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>BigInteger</span> <span class=n>b</span> <span class=o>=</span> <span class=n>getB</span><span class=o>(</span><span class=n>input</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>BigInteger</span> <span class=n>mod</span> <span class=o>=</span> <span class=n>b</span><span class=o>.</span><span class=na>modPow</span><span class=o>(</span><span class=n>v1</span><span class=o>,</span> <span class=n>v2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>mod</span><span class=o>.</span><span class=na>toString</span><span class=o>(</span><span class=n>16</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>BigInteger</span> <span class=nf>getB</span><span class=o>(</span><span class=n>String</span> <span class=n>input</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>BigInteger</span> <span class=n>res</span> <span class=o>=</span> <span class=n>BigInteger</span><span class=o>.</span><span class=na>ZERO</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>input</span><span class=o>.</span><span class=na>length</span><span class=o>();</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>b</span> <span class=o>=</span> <span class=n>input</span><span class=o>.</span><span class=na>charAt</span><span class=o>(</span><span class=n>i</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>BigInteger</span> <span class=n>bi</span> <span class=o>=</span> <span class=n>BigInteger</span><span class=o>.</span><span class=na>valueOf</span><span class=o>(</span><span class=n>b</span><span class=o>).</span><span class=na>shiftLeft</span><span class=o>(</span><span class=n>i</span> <span class=o>*</span> <span class=n>8</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>res</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=na>or</span><span class=o>(</span><span class=n>bi</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>res</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>虽然我们提取了很多中间值，但其实关乎用户输入的只有真实请求 json 和随机数两项。接下来所有类似的接口都是这个加密方式，只需要再从网页是 debug，得到请求 json 的结构，就能发出正确的请求了</p><p>到此，网易云音乐 web 接口分析告一段落。</p><h2 id=题外话>题外话</h2><p>网易接口这种加密方式是比较有趣且常见的加密方式。使用到了 AES 和 RSA 加密方法结合。</p><p>RSA 是一种非对称加密，我们使用客户端公钥加密的数据，只可能使用服务端的私钥进行解密。但是，RSA 是基于大数计算的加密算法，效率较差。原文长度不能超过密钥中 n 的长度，即原文过长，则需要一个更大的合数参与模运算，势必降低加密性能。</p><p>而 AES 是一种对称加密方式，虽然性能提升了，但是不可避免地会将密钥泄露到客户端中。</p><p>因此，这里的解决方案是使用一个随机数作为 AES 的密钥将原文进行加密，然后将随机数使用 RSA 加密后传到服务端。由于随机数的长度是短且固定的，因此 RSA 也就不需要生成过长的密钥。服务端只需要用 RSA 私钥解密得到随机数后，用随机数进行 AES 解密即可得到原文。</p><p>这种 AES + RSA 的解决方案，是很常用的技巧，希望大家可以学以致用。</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2022-08-03</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/%E9%80%86%E5%90%91/>逆向</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/test/cors-test/ class=prev rel=prev title=偷懒的Cors测试><i class="fas fa-angle-left fa-fw"></i>偷懒的Cors测试</a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.103.1">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/HEIGE-PCloud/DoIt target=_blank rel="noopener noreffer" title="DoIt 0.2.13"><i class="far fa-edit fa-fw"></i> DoIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2021 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank rel="noopener noreferrer"></a></span></div></div></footer></div><div id=fixed-buttons><a href=#back-to-top id=back-to-top-button class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><div class=assets><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/fuse/fuse.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/topbar/topbar.min.js></script><script type=text/javascript src=/lib/pjax/pjax.min.js></script><script type=text/javascript src=/js/theme.min.js></script></div><div class=pjax-assets><script type=text/javascript src=https://ryoii-blog.disqus.com/embed.js defer></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/typeit/typeit.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:30},comment:{},data:{"desktop-header-typeit":"Ryoii Blog","mobile-header-typeit":"Ryoii Blog"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/index.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:50,threshold:.3,type:"fuse",useExtendedSearch:!1},typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"desktop-header-typeit":["desktop-header-typeit"],"mobile-header-typeit":["mobile-header-typeit"]},duration:-1,speed:100}}</script><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/katex/katex.min.css><noscript><link rel=stylesheet href=/lib/katex/katex.min.css></noscript><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/katex/copy-tex.min.css><noscript><link rel=stylesheet href=/lib/katex/copy-tex.min.css></noscript></div></body></html>